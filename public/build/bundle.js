var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function r(t){t.forEach(e)}function i(t){return"function"==typeof t}function a(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function o(t,e){t.appendChild(e)}function s(t,e,n){t.insertBefore(e,n||null)}function l(t){t.parentNode&&t.parentNode.removeChild(t)}function c(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function d(t){return document.createElement(t)}function u(t){return document.createTextNode(t)}function h(){return u(" ")}function f(){return u("")}function p(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function m(t){return function(e){return e.preventDefault(),t.call(this,e)}}function _(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function g(t){return""===t?null:+t}function w(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function b(t,e){t.value=null==e?"":e}function E(t,e,n,r){null===n?t.style.removeProperty(e):t.style.setProperty(e,n,r?"important":"")}function y(t,e){for(let n=0;n<t.options.length;n+=1){const r=t.options[n];if(r.__value===e)return void(r.selected=!0)}t.selectedIndex=-1}function v(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}let k,T;function x(){if(void 0===k){k=!1;try{"undefined"!=typeof window&&window.parent&&window.parent.document}catch(t){k=!0}}return k}class A{constructor(t=!1){this.is_svg=!1,this.is_svg=t,this.e=this.n=null}c(t){this.h(t)}m(t,e,n=null){var r;this.e||(this.is_svg?this.e=(r=e.nodeName,document.createElementNS("http://www.w3.org/2000/svg",r)):this.e=d(e.nodeName),this.t=e,this.c(t)),this.i(n)}h(t){this.e.innerHTML=t,this.n=Array.from(this.e.childNodes)}i(t){for(let e=0;e<this.n.length;e+=1)s(this.t,this.n[e],t)}p(t){this.d(),this.h(t),this.i(this.a)}d(){this.n.forEach(l)}}function N(t){T=t}function S(){if(!T)throw new Error("Function called outside component initialization");return T}function I(){const t=S();return(e,n,{cancelable:r=!1}={})=>{const i=t.$$.callbacks[e];if(i){const a=function(t,e,{bubbles:n=!1,cancelable:r=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(t,n,r,e),i}(e,n,{cancelable:r});return i.slice().forEach((e=>{e.call(t,a)})),!a.defaultPrevented}return!0}}function C(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach((t=>t.call(this,e)))}const M=[],R=[],D=[],U=[],z=Promise.resolve();let O=!1;function $(t){D.push(t)}function L(t){U.push(t)}const P=new Set;let F=0;function V(){if(0!==F)return;const t=T;do{try{for(;F<M.length;){const t=M[F];F++,N(t),B(t.$$)}}catch(t){throw M.length=0,F=0,t}for(N(null),M.length=0,F=0;R.length;)R.pop()();for(let t=0;t<D.length;t+=1){const e=D[t];P.has(e)||(P.add(e),e())}D.length=0}while(M.length);for(;U.length;)U.pop()();O=!1,P.clear(),N(t)}function B(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach($)}}const H=new Set;let Z;function q(){Z={r:0,c:[],p:Z}}function j(){Z.r||r(Z.c),Z=Z.p}function G(t,e){t&&t.i&&(H.delete(t),t.i(e))}function K(t,e,n,r){if(t&&t.o){if(H.has(t))return;H.add(t),Z.c.push((()=>{H.delete(t),r&&(n&&t.d(1),r())})),t.o(e)}else r&&r()}const W="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function Y(t,e,n){const r=t.$$.props[e];void 0!==r&&(t.$$.bound[r]=n,n(t.$$.ctx[r]))}function X(t){t&&t.c()}function Q(t,n,a,o){const{fragment:s,after_update:l}=t.$$;s&&s.m(n,a),o||$((()=>{const n=t.$$.on_mount.map(e).filter(i);t.$$.on_destroy?t.$$.on_destroy.push(...n):r(n),t.$$.on_mount=[]})),l.forEach($)}function J(t,e){const n=t.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function tt(t,e){-1===t.$$.dirty[0]&&(M.push(t),O||(O=!0,z.then(V)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function et(e,i,a,o,s,c,d,u=[-1]){const h=T;N(e);const f=e.$$={fragment:null,ctx:[],props:c,update:t,not_equal:s,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(i.context||(h?h.$$.context:[])),callbacks:n(),dirty:u,skip_bound:!1,root:i.target||h.$$.root};d&&d(f.root);let p=!1;if(f.ctx=a?a(e,i.props||{},((t,n,...r)=>{const i=r.length?r[0]:n;return f.ctx&&s(f.ctx[t],f.ctx[t]=i)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](i),p&&tt(e,t)),n})):[],f.update(),p=!0,r(f.before_update),f.fragment=!!o&&o(f.ctx),i.target){if(i.hydrate){const t=function(t){return Array.from(t.childNodes)}(i.target);f.fragment&&f.fragment.l(t),t.forEach(l)}else f.fragment&&f.fragment.c();i.intro&&G(e.$$.fragment),Q(e,i.target,i.anchor,i.customElement),V()}N(h)}class nt{$destroy(){J(this,1),this.$destroy=t}$on(e,n){if(!i(n))return t;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const t=r.indexOf(n);-1!==t&&r.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}var rt=Object.defineProperty,it=Object.defineProperties,at=Object.getOwnPropertyDescriptors,ot=Object.getOwnPropertySymbols,st=Object.prototype.hasOwnProperty,lt=Object.prototype.propertyIsEnumerable,ct=Math.pow,dt=(t,e,n)=>e in t?rt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ut=(t,e)=>{for(var n in e||(e={}))st.call(e,n)&&dt(t,n,e[n]);if(ot)for(var n of ot(e))lt.call(e,n)&&dt(t,n,e[n]);return t},ht=(t,e)=>it(t,at(e)),ft=(t,e)=>{var n={};for(var r in t)st.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&ot)for(var r of ot(t))e.indexOf(r)<0&&lt.call(t,r)&&(n[r]=t[r]);return n},pt=(t,e,n)=>new Promise(((r,i)=>{var a=t=>{try{s(n.next(t))}catch(t){i(t)}},o=t=>{try{s(n.throw(t))}catch(t){i(t)}},s=t=>t.done?r(t.value):Promise.resolve(t.value).then(a,o);s((n=n.apply(t,e)).next())}));const mt="p".charCodeAt(0),_t="H".charCodeAt(0),gt="Y".charCodeAt(0),wt="s".charCodeAt(0);let bt;function Et(t){let e=-1;bt||(bt=function(){const t=new Int32Array(256);for(let e=0;e<256;e++){let n=e;for(let t=0;t<8;t++)n=1&n?3988292384^n>>>1:n>>>1;t[e]=n}return t}());for(let n=0;n<t.length;n++)e=bt[255&(e^t[n])]^e>>>8;return-1^e}function yt(t,e,n=!1){const r=new Uint8Array(13);e*=39.3701,r[0]=mt,r[1]=_t,r[2]=gt,r[3]=wt,r[4]=e>>>24,r[5]=e>>>16,r[6]=e>>>8,r[7]=255&e,r[8]=r[4],r[9]=r[5],r[10]=r[6],r[11]=r[7],r[12]=1;const i=Et(r),a=new Uint8Array(4);if(a[0]=i>>>24,a[1]=i>>>16,a[2]=i>>>8,a[3]=255&i,n){const e=function(t){for(let e=t.length-1;e>=4;e--)if(9===t[e-4]&&t[e-3]===mt&&t[e-2]===_t&&t[e-1]===gt&&t[e]===wt)return e-3;return 0}(t);return t.set(r,e),t.set(a,e+13),t}{const e=new Uint8Array(4);e[0]=0,e[1]=0,e[2]=0,e[3]=9;const n=new Uint8Array(54);return n.set(t,0),n.set(e,33),n.set(r,37),n.set(a,50),n}}const vt="[modern-screenshot]",kt="undefined"!=typeof window,Tt=kt&&"Worker"in window,xt=kt&&"atob"in window;var At;const Nt=kt?null==(At=window.navigator)?void 0:At.userAgent:"",St=Nt.includes("Chrome"),It=Nt.includes("AppleWebKit")&&!St,Ct=Nt.includes("Firefox"),Mt=t=>t&&"__CONTEXT__"in t,Rt=t=>"CSSFontFaceRule"===t.constructor.name,Dt=t=>"CSSImportRule"===t.constructor.name,Ut=t=>1===t.nodeType,zt=t=>"object"==typeof t.className,Ot=t=>"image"===t.tagName,$t=t=>"use"===t.tagName,Lt=t=>Ut(t)&&void 0!==t.style&&!zt(t),Pt=t=>8===t.nodeType,Ft=t=>3===t.nodeType,Vt=t=>"IMG"===t.tagName,Bt=t=>"VIDEO"===t.tagName,Ht=t=>"CANVAS"===t.tagName,Zt=t=>"TEXTAREA"===t.tagName,qt=t=>"INPUT"===t.tagName,jt=t=>"STYLE"===t.tagName,Gt=t=>"SCRIPT"===t.tagName,Kt=t=>"SELECT"===t.tagName,Wt=t=>"SLOT"===t.tagName,Yt=t=>"IFRAME"===t.tagName,Xt=(...t)=>console.warn(vt,...t),Qt=t=>console.time(`${vt} ${t}`),Jt=t=>console.timeEnd(`${vt} ${t}`),te=t=>{var e;const n=null==(e=null==t?void 0:t.createElement)?void 0:e.call(t,"canvas");return n&&(n.height=n.width=1),n&&"toDataURL"in n&&Boolean(n.toDataURL("image/webp").includes("image/webp"))},ee=t=>t.startsWith("data:");function ne(t,e){if(t.match(/^[a-z]+:\/\//i))return t;if(kt&&t.match(/^\/\//))return window.location.protocol+t;if(t.match(/^[a-z]+:/i)||!kt)return t;const n=re().implementation.createHTMLDocument(),r=n.createElement("base"),i=n.createElement("a");return n.head.appendChild(r),n.body.appendChild(i),e&&(r.href=e),i.href=t,i.href}function re(t){var e;return null!=(e=t&&Ut(t)?null==t?void 0:t.ownerDocument:t)?e:window.document}const ie="http://www.w3.org/2000/svg";function ae(t,e="image/png",n=1){return pt(this,null,(function*(){try{return yield new Promise(((r,i)=>{t.toBlob((t=>{t?r(t):i(new Error("Blob is null"))}),e,n)}))}catch(r){if(xt)return Xt("Failed canvas to blob",{type:e,quality:n},r),function(t){var e,n;const[r,i]=t.split(","),a=null!=(n=null==(e=r.match(/data:(.+);/))?void 0:e[1])?n:void 0,o=window.atob(i),s=o.length,l=new Uint8Array(s);for(let t=0;t<s;t+=1)l[t]=o.charCodeAt(t);return new Blob([l],{type:a})}(t.toDataURL(e,n));throw r}}))}function oe(t,e){return new Promise(((n,r)=>{const i=new FileReader;i.onload=()=>n(i.result),i.onerror=()=>r(i.error),i.onabort=()=>r(new Error(`Failed read blob to ${e}`)),"dataUrl"===e?i.readAsDataURL(t):"arrayBuffer"===e&&i.readAsArrayBuffer(t)}))}const se=t=>oe(t,"dataUrl"),le=t=>oe(t,"arrayBuffer");function ce(t,e){const n=re(e).createElement("img");return n.decoding="sync",n.loading="eager",n.src=t,n}function de(t,e){return new Promise((n=>{const{timeout:r,ownerDocument:i,onError:a}=null!=e?e:{},o="string"==typeof t?ce(t,re(i)):t;let s=null,l=null;function c(){n(o),s&&clearTimeout(s),null==l||l()}if(r&&(s=setTimeout(c,r)),Bt(o)){const t=o.currentSrc||o.src;if(!t)return o.poster?de(o.poster,e).then(n):c();if(o.readyState>=2)return c();const r=c,i=e=>{Xt("Failed video load",t,e),null==a||a(e),c()};l=()=>{o.removeEventListener("loadeddata",r),o.removeEventListener("error",i)},o.addEventListener("loadeddata",r,{once:!0}),o.addEventListener("error",i,{once:!0})}else{const t=Ot(o)?o.href.baseVal:o.currentSrc||o.src;if(!t)return c();const e=()=>pt(this,null,(function*(){if(Vt(o)&&"decode"in o)try{yield o.decode()}catch(e){Xt("Failed to decode image, trying to render anyway",o.dataset.originalSrc||t,e)}c()})),n=e=>{Xt("Failed image load",o.dataset.originalSrc||t,e),c()};if(Vt(o)&&o.complete)return e();l=()=>{o.removeEventListener("load",e),o.removeEventListener("error",n)},o.addEventListener("load",e,{once:!0}),o.addEventListener("error",n,{once:!0})}}))}const ue=function(){let t=0;return()=>(t+=1,`u${`0000${(Math.random()*ct(36,4)<<0).toString(36)}`.slice(-4)}${t}`)}();function he(t){return null==t?void 0:t.split(",").map((t=>t.trim().replace(/"|'/g,"").toLowerCase())).filter(Boolean)}function fe(t){return{time:e=>t&&Qt(e),timeEnd:e=>t&&Jt(e),warn:(...e)=>t&&Xt(...e)}}function pe(t){return{cache:t?"no-cache":"force-cache"}}function me(t,e){return pt(this,null,(function*(){return Mt(t)?t:function(t,e){return pt(this,null,(function*(){var n,r,i,a,o;const{scale:s=1,workerUrl:l,workerNumber:c=1}=e||{},d=Boolean(null==e?void 0:e.debug),u=null==(n=null==e?void 0:e.features)||n,h=null!=(r=t.ownerDocument)?r:kt?window.document:void 0,f=null!=(a=null==(i=t.ownerDocument)?void 0:i.defaultView)?a:kt?window:void 0,p=new Map,m=ht(ut({width:0,height:0,quality:1,type:"image/png",scale:s,backgroundColor:null,style:null,filter:null,maximumCanvasSize:0,timeout:3e4,progress:null,debug:d,fetch:ut({requestInit:pe(null==(o=null==e?void 0:e.fetch)?void 0:o.bypassingCache),placeholderImage:"data:image/png;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",bypassingCache:!1},null==e?void 0:e.fetch),fetchFn:null,font:{},drawImageInterval:100,workerUrl:null,workerNumber:c,onCloneNode:null,onEmbedNode:null,onCreateForeignObjectSvg:null,includeStyleProperties:null,autoDestruct:!1},e),{__CONTEXT__:!0,log:fe(d),node:t,ownerDocument:h,ownerWindow:f,dpi:1===s?null:96*s,svgStyleElement:_e(h),svgDefsElement:null==h?void 0:h.createElementNS(ie,"defs"),svgStyles:new Map,defaultComputedStyles:new Map,workers:[...new Array(Tt&&l&&c?c:0)].map((()=>{try{const t=new Worker(l);return t.onmessage=t=>pt(this,null,(function*(){var e,n,r,i;const{url:a,result:o}=t.data;o?null==(n=null==(e=p.get(a))?void 0:e.resolve)||n.call(e,o):null==(i=null==(r=p.get(a))?void 0:r.reject)||i.call(r,new Error(`Error receiving message from worker: ${a}`))})),t.onmessageerror=t=>{var e,n;const{url:r}=t.data;null==(n=null==(e=p.get(r))?void 0:e.reject)||n.call(e,new Error(`Error receiving message from worker: ${r}`))},t}catch(t){return Xt("Failed to new Worker",t),null}})).filter(Boolean),fontFamilies:new Set,fontCssTexts:new Map,acceptOfImage:`${[te(h)&&"image/webp","image/svg+xml","image/*","*/*"].filter(Boolean).join(",")};q=0.8`,requests:p,drawImageCount:0,tasks:[],features:u,isEnable:t=>{var e;return"boolean"==typeof u?u:null==(e=u[t])||e}});m.log.time("wait until load"),yield function(t,e){return pt(this,null,(function*(){Lt(t)&&(Vt(t)||Bt(t)?yield de(t,{timeout:e}):yield Promise.all(["img","video"].flatMap((n=>Array.from(t.querySelectorAll(n)).map((t=>de(t,{timeout:e})))))))}))}(t,m.timeout),m.log.timeEnd("wait until load");const{width:_,height:g}=function(t,e){let{width:n,height:r}=e;if(Ut(t)&&(!n||!r)){const e=t.getBoundingClientRect();n=n||e.width||Number(t.getAttribute("width"))||0,r=r||e.height||Number(t.getAttribute("height"))||0}return{width:n,height:r}}(t,m);return m.width=_,m.height=g,m}))}(t,ht(ut({},e),{autoDestruct:!0}))}))}function _e(t){if(!t)return;const e=t.createElement("style"),n=e.ownerDocument.createTextNode("\n.______background-clip--text {\n  background-clip: text;\n  -webkit-background-clip: text;\n}\n");return e.appendChild(n),e}function ge(t,e){return pt(this,null,(function*(){const{log:n,timeout:r,drawImageCount:i,drawImageInterval:a}=e;n.time("image to canvas");const o=yield de(t,{timeout:r}),{canvas:s,context2d:l}=function(t,e){const{width:n,height:r,scale:i,backgroundColor:a,maximumCanvasSize:o}=e,s=t.createElement("canvas");s.width=Math.floor(n*i),s.height=Math.floor(r*i),s.style.width=`${n}px`,s.style.height=`${r}px`,o&&(s.width>o||s.height>o)&&(s.width>o&&s.height>o?s.width>s.height?(s.height*=o/s.width,s.width=o):(s.width*=o/s.height,s.height=o):s.width>o?(s.height*=o/s.width,s.width=o):(s.width*=o/s.height,s.height=o));const l=s.getContext("2d");return l&&a&&(l.fillStyle=a,l.fillRect(0,0,s.width,s.height)),{canvas:s,context2d:l}}(t.ownerDocument,e),c=()=>{try{null==l||l.drawImage(o,0,0,s.width,s.height)}catch(t){Xt("Failed to drawImage",t)}};if(c(),e.isEnable("fixSvgXmlDecode"))for(let t=0;t<i;t++)yield new Promise((e=>{setTimeout((()=>{c(),e()}),t+a)}));return e.drawImageCount=0,n.timeEnd("image to canvas"),s}))}const we=["width","height","-webkit-text-fill-color"],be=["stroke","fill"];function Ee(t,e,n){var r;const{defaultComputedStyles:i,ownerDocument:a}=n,o=t.nodeName.toLowerCase(),s=zt(t)&&"svg"!==o,l=s?be.map((e=>[e,t.getAttribute(e)])).filter((([,t])=>null!==t)):[],c=[s&&"svg",o,l.map(((t,e)=>`${t}=${e}`)).join(","),e].filter(Boolean).join(":");if(i.has(c))return i.get(c);let d=n.sandbox;if(!d)try{a&&(d=a.createElement("iframe"),d.id=`__SANDBOX__-${ue()}`,d.width="0",d.height="0",d.style.visibility="hidden",d.style.position="fixed",a.body.appendChild(d),null==(r=d.contentWindow)||r.document.write('<!DOCTYPE html><meta charset="UTF-8"><title></title><body>'),n.sandbox=d)}catch(t){Xt("Failed to create iframe sandbox",t)}if(!d)return new Map;const u=d.contentWindow;if(!u)return new Map;const h=u.document;let f,p;s?(f=h.createElementNS(ie,"svg"),p=f.ownerDocument.createElementNS(f.namespaceURI,o),l.forEach((([t,e])=>{p.setAttributeNS(null,t,e)})),f.appendChild(p)):f=p=h.createElement(o),p.textContent=" ",h.body.appendChild(f);const m=u.getComputedStyle(p,e),_=new Map;for(let t=m.length,e=0;e<t;e++){const t=m.item(e);we.includes(t)||_.set(t,m.getPropertyValue(t))}return h.body.removeChild(f),i.set(c,_),_}function ye(t,e,n){var r;const i=new Map,a=[],o=new Map;if(n)for(const t of n)s(t);else for(let e=t.length,n=0;n<e;n++){s(t.item(n))}for(let t=a.length,e=0;e<t;e++)null==(r=o.get(a[e]))||r.forEach(((t,e)=>i.set(e,t)));function s(n){const r=t.getPropertyValue(n),s=t.getPropertyPriority(n),l=n.lastIndexOf("-"),c=l>-1?n.substring(0,l):void 0;if(c){let t=o.get(c);t||(t=new Map,o.set(c,t)),t.set(n,[r,s])}e.get(n)===r&&!s||(c?a.push(c):i.set(n,[r,s]))}return i}const ve=[":before",":after"],ke=[":-webkit-scrollbar",":-webkit-scrollbar-button",":-webkit-scrollbar-thumb",":-webkit-scrollbar-track",":-webkit-scrollbar-track-piece",":-webkit-scrollbar-corner",":-webkit-resizer"];function Te(t){if(t.ownerDocument)try{const e=t.toDataURL();if("data:,"!==e)return ce(e,t.ownerDocument)}catch(t){}const e=t.cloneNode(!1),n=t.getContext("2d"),r=e.getContext("2d");try{return n&&r&&r.putImageData(n.getImageData(0,0,t.width,t.height),0,0),e}catch(t){Xt("Failed to clone canvas",t)}return e}function xe(t,e){return Ht(t)?Te(t):Yt(t)?function(t,e){var n;try{if(null!=(n=null==t?void 0:t.contentDocument)&&n.body)return Ce(t.contentDocument.body,e)}catch(t){Xt("Failed to clone iframe",t)}return t.cloneNode(!1)}(t,e):Vt(t)?function(t){const e=t.cloneNode(!1);return t.currentSrc&&t.currentSrc!==t.src&&(e.src=t.currentSrc,e.srcset=""),"lazy"===e.loading&&(e.loading="eager"),e}(t):Bt(t)?function(t){return pt(this,null,(function*(){if(t.ownerDocument&&!t.currentSrc&&t.poster)return ce(t.poster,t.ownerDocument);const e=t.cloneNode(!1);e.crossOrigin="anonymous",t.currentSrc&&t.currentSrc!==t.src&&(e.src=t.currentSrc);const n=e.ownerDocument;if(n){let r=!0;if(yield de(e,{onError:()=>r=!1}),!r)return t.poster?ce(t.poster,t.ownerDocument):e;e.currentTime=t.currentTime,yield new Promise((t=>{e.addEventListener("seeked",t,{once:!0})}));const i=n.createElement("canvas");i.width=t.offsetWidth,i.height=t.offsetHeight;try{const t=i.getContext("2d");t&&t.drawImage(e,0,0,i.width,i.height)}catch(n){return Xt("Failed to clone video",n),t.poster?ce(t.poster,t.ownerDocument):e}return Te(i)}return e}))}(t):t.cloneNode(!1)}const Ae=new Set(["symbol"]);function Ne(t,e,n){return pt(this,null,(function*(){Ut(e)&&(jt(e)||Gt(e))||n.filter&&!n.filter(e)||(Ae.has(t.nodeName)||Ae.has(e.nodeName)?n.currentParentNodeStyle=void 0:n.currentParentNodeStyle=n.currentNodeStyle,t.appendChild(yield Ce(e,n)))}))}function Se(t,e,n){return pt(this,null,(function*(){var r,i;for(let a=null!=(i=Ut(t)?null==(r=t.shadowRoot)?void 0:r.firstChild:void 0)?i:t.firstChild;a;a=a.nextSibling)if(!Pt(a))if(Ut(a)&&Wt(a)&&"function"==typeof a.assignedNodes){const t=a.assignedNodes();for(let r=0;r<t.length;r++)yield Ne(e,t[r],n)}else yield Ne(e,a,n)}))}const Ie=/^[\w-:]+$/;function Ce(t,e,n=!1){return pt(this,null,(function*(){var r,i,a,o;const{ownerDocument:s,ownerWindow:l,fontFamilies:c}=e;if(s&&Ft(t))return s.createTextNode(t.data);if(s&&l&&Ut(t)&&(Lt(t)||zt(t))){const s=yield xe(t,e);if(e.isEnable("removeAbnormalAttributes")){const t=s.getAttributeNames();for(let e=t.length,n=0;n<e;n++){const e=t[n];Ie.test(e)||s.removeAttribute(e)}}const l=e.currentNodeStyle=function(t,e,n,r){var i,a,o,s;const{ownerWindow:l,includeStyleProperties:c,currentParentNodeStyle:d}=r,u=e.style,h=l.getComputedStyle(t),f=Ee(t,null,r);null==d||d.forEach(((t,e)=>{f.delete(e)}));const p=ye(h,f,c);return p.delete("transition-property"),p.delete("all"),p.delete("d"),p.delete("content"),n&&(p.delete("margin-top"),p.delete("margin-right"),p.delete("margin-bottom"),p.delete("margin-left"),p.delete("margin-block-start"),p.delete("margin-block-end"),p.delete("margin-inline-start"),p.delete("margin-inline-end"),p.set("box-sizing",["border-box",""])),"text"===(null==(i=p.get("background-clip"))?void 0:i[0])&&e.classList.add("______background-clip--text"),St&&(p.has("font-kerning")||p.set("font-kerning",["normal",""]),("hidden"===(null==(a=p.get("overflow-x"))?void 0:a[0])||"hidden"===(null==(o=p.get("overflow-y"))?void 0:o[0]))&&"ellipsis"===(null==(s=p.get("text-overflow"))?void 0:s[0])&&t.scrollWidth===t.clientWidth&&p.set("text-overflow",["clip",""])),p.forEach((([t,e],n)=>{u.setProperty(n,t,e)})),p}(t,s,n,e);n&&function(t,e){const{backgroundColor:n,width:r,height:i,style:a}=e,o=t.style;if(n&&o.setProperty("background-color",n,"important"),r&&o.setProperty("width",`${r}px`,"important"),i&&o.setProperty("height",`${i}px`,"important"),a)for(const t in a)o[t]=a[t]}(s,e);let d=!1;if(e.isEnable("copyScrollbar")){const e=[null==(r=l.get("overflow-x"))?void 0:r[0],null==(i=l.get("overflow-y"))?void 0:i[1]];d=e.includes("scroll")||(e.includes("auto")||e.includes("overlay"))&&(t.scrollHeight>t.clientHeight||t.scrollWidth>t.clientWidth)}return function(t,e,n,r){const{ownerWindow:i,svgStyleElement:a,svgStyles:o,currentNodeStyle:s}=r;function l(n){var a;const l=i.getComputedStyle(t,n);let c=l.getPropertyValue("content");if(!c||"none"===c)return;c=c.replace(/(')|(")|(counter\(.+\))/g,"");const d=[ue()],u=Ee(t,n,r);null==s||s.forEach(((t,e)=>{u.delete(e)}));const h=ye(l,u,r.includeStyleProperties);h.delete("content"),h.delete("-webkit-locale"),"text"===(null==(a=h.get("background-clip"))?void 0:a[0])&&e.classList.add("______background-clip--text");const f=[`content: '${c}';`];if(h.forEach((([t,e],n)=>{f.push(`${n}: ${t}${e?" !important":""};`)})),1===f.length)return;try{e.className=[e.className,...d].join(" ")}catch(t){return}const p=f.join("\n  ");let m=o.get(p);m||(m=[],o.set(p,m)),m.push(`.${d[0]}:${n}`)}a&&i&&(ve.forEach(l),n&&ke.forEach(l))}(t,s,d,e),function(t,e){Zt(t)&&(e.innerHTML=t.value),(Zt(t)||qt(t)||Kt(t))&&e.setAttribute("value",t.value)}(t,s),null==(o=he(null==(a=l.get("font-family"))?void 0:a[0]))||o.forEach((t=>c.add(t))),Bt(t)||(yield Se(t,s,e)),s}const d=t.cloneNode(!1);return yield Se(t,d,e),d}))}function Me(t,e){const{url:n,requestType:r="text",responseType:i="text",imageDom:a}=e;let o=n;const{timeout:s,acceptOfImage:l,requests:c,fetchFn:d,fetch:{requestInit:u,bypassingCache:h,placeholderImage:f},workers:p}=t;"image"===r&&(It||Ct)&&t.drawImageCount++;let m=c.get(n);if(!m){h&&h instanceof RegExp&&h.test(o)&&(o+=(/\?/.test(o)?"&":"?")+(new Date).getTime());const t=ut({url:o,timeout:s,responseType:i,headers:"image"===r?{accept:l}:void 0},u);m={type:r,resolve:void 0,reject:void 0,response:null},m.response=(()=>pt(this,null,(function*(){if(d&&"image"===r){const t=yield d(n);if(t)return t}return!It&&n.startsWith("http")&&p.length?new Promise(((e,r)=>{p[c.size&p.length-1].postMessage(ut({rawUrl:n},t)),m.resolve=e,m.reject=r})):function(t){const e=t,{url:n,timeout:r,responseType:i}=e,a=ft(e,["url","timeout","responseType"]),o=new AbortController,s=r?setTimeout((()=>o.abort()),r):void 0;return fetch(n,ut({signal:o.signal},a)).then((t=>{if(!t.ok)throw new Error("Failed fetch, not 2xx response",{cause:t});return"dataUrl"===i?t.blob().then(se):t.text()})).finally((()=>clearTimeout(s)))}(t)})))().catch((t=>{if(c.delete(n),"image"===r&&f)return Xt("Failed to fetch image base64, trying to use placeholder image",o),"string"==typeof f?f:f(a);throw t})),c.set(n,m)}return m.response}function Re(t,e,n,r){return pt(this,null,(function*(){if(!De(t))return t;for(const[i,a]of function(t,e){const n=[];return t.replace(Ue,((t,r,i)=>(n.push([i,ne(i,e)]),t))),n.filter((([t])=>!ee(t)))}(t,e))try{const e=yield Me(n,{url:a,requestType:r?"image":"text",responseType:"dataUrl"});t=t.replace(ze(i),`$1${e}$3`)}catch(t){Xt("Failed to fetch css data url",i,t)}return t}))}function De(t){return/url\((['"]?)([^'"]+?)\1\)/.test(t)}const Ue=/url\((['"]?)([^'"]+?)\1\)/g;function ze(t){const e=t.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${e})(['"]?\\))`,"g")}function Oe(t,e){return pt(this,null,(function*(){const{ownerDocument:t,svgStyleElement:n,fontFamilies:r,fontCssTexts:i,tasks:a,font:o}=e;if(t&&n&&r.size)if(o&&o.cssText){const r=Ve(o.cssText,e);n.appendChild(t.createTextNode(`${r}\n`))}else{const o=Array.from(t.styleSheets).filter((t=>{try{return"cssRules"in t&&Boolean(t.cssRules.length)}catch(e){return Xt(`Error while reading CSS rules from ${t.href}`,e),!1}}));yield Promise.all(o.flatMap((t=>Array.from(t.cssRules).map(((n,r)=>pt(this,null,(function*(){if(Dt(n)){let i=r+1;const a=n.href;let o="";try{o=yield Me(e,{url:a,requestType:"text",responseType:"text"})}catch(t){Xt(`Error fetch remote css import from ${a}`,t)}const s=o.replace(Ue,((t,e,n)=>t.replace(n,ne(n,a))));for(const e of function(t){if(null==t)return[];const e=[];let n=t.replace($e,"");for(;;){const t=Le.exec(n);if(!t)break;e.push(t[0])}n=n.replace(Le,"");const r=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,i=new RegExp("((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})","gi");for(;;){let t=r.exec(n);if(t)i.lastIndex=r.lastIndex;else{if(t=i.exec(n),!t)break;r.lastIndex=i.lastIndex}e.push(t[0])}return e}(s))try{t.insertRule(e,e.startsWith("@import")?i+=1:t.cssRules.length)}catch(t){Xt("Error inserting rule from remote css import",{rule:e,error:t})}}}))))))),o.flatMap((t=>Array.from(t.cssRules))).filter((t=>{var e;return Rt(t)&&De(t.style.getPropertyValue("src"))&&(null==(e=he(t.style.getPropertyValue("font-family")))?void 0:e.some((t=>r.has(t))))})).forEach((r=>{const o=r,s=i.get(o.cssText);s?n.appendChild(t.createTextNode(`${s}\n`)):a.push(Re(o.cssText,o.parentStyleSheet?o.parentStyleSheet.href:null,e).then((r=>{r=Ve(r,e),i.set(o.cssText,r),n.appendChild(t.createTextNode(`${r}\n`))})))}))}}))}const $e=/(\/\*[\s\S]*?\*\/)/gi,Le=/((@.*?keyframes [\s\S]*?){([\s\S]*?}\s*?)})/gi;const Pe=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,Fe=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function Ve(t,e){const{font:n}=e,r=n?null==n?void 0:n.preferredFormat:void 0;return r?t.replace(Fe,(t=>{for(;;){const[e,,n]=Pe.exec(t)||[];if(!n)return"";if(n===r)return`src: ${e};`}})):t}const Be=["background-image","border-image-source","-webkit-border-image","-webkit-mask-image","list-style-image"];function He(t,e){const{tasks:n}=e;Ut(t)&&((Vt(t)||Ot(t))&&n.push(...function(t,e){if(Vt(t)){const n=t.currentSrc||t.src;if(!ee(n))return[Me(e,{url:n,imageDom:t,requestType:"image",responseType:"dataUrl"}).then((e=>{e&&(t.srcset="",t.dataset.originalSrc=n,t.src=e||"")}))];(It||Ct)&&e.drawImageCount++}else if(zt(t)&&!ee(t.href.baseVal)){const n=t.href.baseVal;return[Me(e,{url:n,imageDom:t,requestType:"image",responseType:"dataUrl"}).then((e=>{e&&(t.dataset.originalSrc=n,t.href.baseVal=e||"")}))]}return[]}(t,e)),$t(t)&&n.push(...function(t,e){var n;const{ownerDocument:r,svgDefsElement:i}=e,a=null!=(n=t.getAttribute("href"))?n:t.getAttribute("xlink:href");if(!a)return[];const[o,s]=a.split("#");if(s){const n=`#${s}`,a=null==r?void 0:r.querySelector(`svg ${n}`);if(o&&t.setAttribute("href",n),null!=i&&i.querySelector(n))return[];if(a)return[Ce(a,e).then((t=>{null!=i&&i.querySelector(n)||null==i||i.appendChild(t)}))];if(o)return[Me(e,{url:o,responseType:"text"}).then((t=>{null==i||i.insertAdjacentHTML("beforeend",t)}))]}return[]}(t,e))),Lt(t)&&n.push(...function(t,e){return Be.map((n=>{const r=t.getPropertyValue(n);return r&&"none"!==r?((It||Ct)&&e.drawImageCount++,Re(r,null,e,!0).then((e=>{!e||r===e||t.setProperty(n,e,t.getPropertyPriority(n))}))):null})).filter(Boolean)}(t.style,e)),t.childNodes.forEach((t=>{He(t,e)}))}function Ze(t,e){return pt(this,null,(function*(){const n=yield me(t,e);if(Ut(n.node)&&zt(n.node))return n.node;const{ownerDocument:r,log:i,tasks:a,svgStyleElement:o,svgDefsElement:s,svgStyles:l,font:c,progress:d,autoDestruct:u,onCloneNode:h,onEmbedNode:f,onCreateForeignObjectSvg:p}=n;i.time("clone node");const m=yield Ce(n.node,n,!0);if(o&&r){let t="";l.forEach(((e,n)=>{t+=`${e.join(",\n")} {\n  ${n}\n}\n`})),o.appendChild(r.createTextNode(t))}i.timeEnd("clone node"),null==h||h(m),!1!==c&&Ut(m)&&(i.time("embed web font"),yield Oe(0,n),i.timeEnd("embed web font")),i.time("embed node"),He(m,n);const _=a.length;let g=0;null==d||d(g,_),yield Promise.all([...Array(4)].map((()=>pt(this,null,(function*(){for(;;){const t=a.pop();if(!t)break;try{yield t}catch(t){Xt("Failed to run task",t)}null==d||d(++g,_)}}))))),i.timeEnd("embed node"),null==f||f(m);const w=function(t,e){const{width:n,height:r}=e,i=function(t,e,n){const r=re(n).createElementNS(ie,"svg");return r.setAttributeNS(null,"width",t.toString()),r.setAttributeNS(null,"height",e.toString()),r.setAttributeNS(null,"viewBox",`0 0 ${t} ${e}`),r}(n,r,t.ownerDocument),a=i.ownerDocument.createElementNS(i.namespaceURI,"foreignObject");return a.setAttributeNS(null,"x","0%"),a.setAttributeNS(null,"y","0%"),a.setAttributeNS(null,"width","100%"),a.setAttributeNS(null,"height","100%"),a.append(t),i.appendChild(a),i}(m,n);return s&&w.insertBefore(s,w.children[0]),o&&w.insertBefore(o,w.children[0]),u&&function(t){if(t.ownerDocument=void 0,t.ownerWindow=void 0,t.svgStyleElement=void 0,t.svgDefsElement=void 0,t.svgStyles.clear(),t.defaultComputedStyles.clear(),t.sandbox){try{t.sandbox.remove()}catch(t){}t.sandbox=void 0}t.workers=[],t.fontFamilies.clear(),t.fontCssTexts.clear(),t.requests.clear(),t.tasks=[]}(n),null==p||p(w),w}))}function qe(t,e){return pt(this,null,(function*(){var n;const r=yield me(t,e),i=yield Ze(r),a=function(t,e){let n=(new XMLSerializer).serializeToString(t);return e&&(n=n.replace(/[\u0000-\u0008\u000B\u000C\u000E-\u001F\uD800-\uDFFF\uFFFE\uFFFF]/gu,"")),`data:image/svg+xml;charset=utf-8,${encodeURIComponent(n)}`}(i,r.isEnable("removeControlCharacter"));r.autoDestruct||(r.svgStyleElement=_e(r.ownerDocument),r.svgDefsElement=null==(n=r.ownerDocument)?void 0:n.createElementNS(ie,"defs"),r.svgStyles.clear());const o=ce(a,i.ownerDocument);return yield ge(o,r)}))}function je(t){let e;if(t){if(!(t instanceof ArrayBuffer))throw Error("Invalid buffer received.");if(this.datas=new DataView(t,0,je.HEADER_LENGTH),"M"!==String.fromCharCode(this.datas.getUint8(0))||"T"!==String.fromCharCode(this.datas.getUint8(1))||"h"!==String.fromCharCode(this.datas.getUint8(2))||"d"!==String.fromCharCode(this.datas.getUint8(3)))throw new Error("Invalid MIDIFileHeader : MThd prefix not found");if(6!==this.datas.getUint32(4))throw new Error("Invalid MIDIFileHeader : Chunk length must be 6")}else e=new Uint8Array(je.HEADER_LENGTH),e[0]=77,e[1]=84,e[2]=104,e[3]=100,e[4]=0,e[5]=0,e[6]=0,e[7]=6,e[8]=0,e[9]=1,e[10]=0,e[11]=1,e[12]=0,e[13]=192,this.datas=new DataView(e.buffer,0,je.HEADER_LENGTH)}je.HEADER_LENGTH=14,je.FRAMES_PER_SECONDS=1,je.TICKS_PER_BEAT=2,je.prototype.getFormat=function(){const t=this.datas.getUint16(8);if(0!==t&&1!==t&&2!==t)throw new Error("Invalid MIDI file : MIDI format ("+t+"), format can be 0, 1 or 2 only.");return t},je.prototype.setFormat=function(t){if(0!==t&&1!==t&&2!==t)throw new Error("Invalid MIDI format given ("+t+"), format can be 0, 1 or 2 only.");this.datas.setUint16(8,t)},je.prototype.getTracksCount=function(){return this.datas.getUint16(10)},je.prototype.setTracksCount=function(t){return this.datas.setUint16(10,t)},je.prototype.getTickResolution=function(t){return 32768&this.datas.getUint16(12)?1e6/(this.getSMPTEFrames()*this.getTicksPerFrame()):(t=t||5e5)/this.getTicksPerBeat()},je.prototype.getTimeDivision=function(){return 32768&this.datas.getUint16(12)?je.FRAMES_PER_SECONDS:je.TICKS_PER_BEAT},je.prototype.getTicksPerBeat=function(){var t=this.datas.getUint16(12);if(32768&t)throw new Error("Time division is not expressed as ticks per beat.");return t},je.prototype.setTicksPerBeat=function(t){this.datas.setUint16(12,32767&t)},je.prototype.getSMPTEFrames=function(){const t=this.datas.getUint16(12);let e;if(!(32768&t))throw new Error("Time division is not expressed as frames per seconds.");if(e=32512&t,-1===[24,25,29,30].indexOf(e))throw new Error("Invalid SMPTE frames value ("+e+").");return 29===e?29.97:e},je.prototype.getTicksPerFrame=function(){const t=this.datas.getUint16(12);if(!(32768&t))throw new Error("Time division is not expressed as frames per seconds.");return 255&t},je.prototype.setSMTPEDivision=function(t,e){if(29.97===t&&(t=29),-1===[24,25,29,30].indexOf(t))throw new Error("Invalid SMPTE frames value given ("+t+").");if(0>e||255<e)throw new Error("Invalid ticks per frame value given ("+t+").");this.datas.setUint8(12,128|t),this.datas.setUint8(13,e)};var Ge=je;function Ke(t,e){let n,r;if(t){if(!(t instanceof ArrayBuffer))throw new Error("Invalid buffer received.");if(12>t.byteLength-e)throw new Error("Invalid MIDIFileTrack (0x"+e.toString(16)+") : Buffer length must size at least 12bytes");if(this.datas=new DataView(t,e,Ke.HDR_LENGTH),"M"!==String.fromCharCode(this.datas.getUint8(0))||"T"!==String.fromCharCode(this.datas.getUint8(1))||"r"!==String.fromCharCode(this.datas.getUint8(2))||"k"!==String.fromCharCode(this.datas.getUint8(3)))throw new Error("Invalid MIDIFileTrack (0x"+e.toString(16)+") : MTrk prefix not found");if(r=this.getTrackLength(),t.byteLength-e<r)throw new Error("Invalid MIDIFileTrack (0x"+e.toString(16)+") : The track size exceed the buffer length.");if(this.datas=new DataView(t,e,Ke.HDR_LENGTH+r),255!==this.datas.getUint8(Ke.HDR_LENGTH+(r-3))||47!==this.datas.getUint8(Ke.HDR_LENGTH+(r-2))||0!==this.datas.getUint8(Ke.HDR_LENGTH+(r-1)))throw new Error("Invalid MIDIFileTrack (0x"+e.toString(16)+") : No track end event found at the expected index ("+(Ke.HDR_LENGTH+(r-1)).toString(16)+").")}else n=new Uint8Array(12),n[0]=77,n[1]=84,n[2]=114,n[3]=107,n[4]=0,n[5]=0,n[6]=0,n[7]=4,n[8]=0,n[9]=255,n[10]=47,n[11]=0,this.datas=new DataView(n.buffer,0,Ke.HDR_LENGTH+4)}Ke.HDR_LENGTH=8,Ke.prototype.getTrackLength=function(){return this.datas.getUint32(4)},Ke.prototype.setTrackLength=function(t){return this.datas.setUint32(4,t)},Ke.prototype.getTrackContent=function(){return new DataView(this.datas.buffer,this.datas.byteOffset+Ke.HDR_LENGTH,this.datas.byteLength-Ke.HDR_LENGTH)},Ke.prototype.setTrackContent=function(t){let e,n,r,i;const a=t.byteLength-t.byteOffset;if(4>a)throw new Error("Invalid track length, must size at least 4bytes");for(this.datas=new DataView(new Uint8Array(Ke.HDR_LENGTH+a).buffer),this.datas.setUint8(0,77),this.datas.setUint8(1,84),this.datas.setUint8(2,114),this.datas.setUint8(3,107),this.datas.setUint32(4,a),e=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),n=new Uint8Array(this.datas.buffer,Ke.HDR_LENGTH,a),r=0,i=e.length;r<i;r++)n[r]=e[r]};var We=Ke;function Ye(){throw new Error("MIDIEvents function not intended to be run.")}Ye.EVENT_META=255,Ye.EVENT_SYSEX=240,Ye.EVENT_DIVSYSEX=247,Ye.EVENT_MIDI=8,Ye.EVENT_META_SEQUENCE_NUMBER=0,Ye.EVENT_META_TEXT=1,Ye.EVENT_META_COPYRIGHT_NOTICE=2,Ye.EVENT_META_TRACK_NAME=3,Ye.EVENT_META_INSTRUMENT_NAME=4,Ye.EVENT_META_LYRICS=5,Ye.EVENT_META_MARKER=6,Ye.EVENT_META_CUE_POINT=7,Ye.EVENT_META_MIDI_CHANNEL_PREFIX=32,Ye.EVENT_META_END_OF_TRACK=47,Ye.EVENT_META_SET_TEMPO=81,Ye.EVENT_META_SMTPE_OFFSET=84,Ye.EVENT_META_TIME_SIGNATURE=88,Ye.EVENT_META_KEY_SIGNATURE=89,Ye.EVENT_META_SEQUENCER_SPECIFIC=127,Ye.EVENT_MIDI_NOTE_OFF=8,Ye.EVENT_MIDI_NOTE_ON=9,Ye.EVENT_MIDI_NOTE_AFTERTOUCH=10,Ye.EVENT_MIDI_CONTROLLER=11,Ye.EVENT_MIDI_PROGRAM_CHANGE=12,Ye.EVENT_MIDI_CHANNEL_AFTERTOUCH=13,Ye.EVENT_MIDI_PITCH_BEND=14,Ye.MIDI_1PARAM_EVENTS=[Ye.EVENT_MIDI_PROGRAM_CHANGE,Ye.EVENT_MIDI_CHANNEL_AFTERTOUCH],Ye.MIDI_2PARAMS_EVENTS=[Ye.EVENT_MIDI_NOTE_OFF,Ye.EVENT_MIDI_NOTE_ON,Ye.EVENT_MIDI_NOTE_AFTERTOUCH,Ye.EVENT_MIDI_CONTROLLER,Ye.EVENT_MIDI_PITCH_BEND],Ye.createParser=function(t,e,n){var r,i,a,o,s;if(t instanceof DataView&&(t={position:e||0,buffer:t,readUint8:function(){return this.buffer.getUint8(this.position++)},readUint16:function(){var t=this.buffer.getUint16(this.position);return this.position=this.position+2,t},readUint32:function(){var t=this.buffer.getUint16(this.position);return this.position=this.position+2,t},readVarInt:function(){for(var t,e=0,n=0;4>n++;){if(!(128&(t=this.readUint8())))return e+t;e+=127&t,e<<=7}throw new Error("0x"+this.position.toString(16)+": Variable integer length cannot exceed 4 bytes")},readBytes:function(t){for(var e=[];0<t;t--)e.push(this.readUint8());return e},pos:function(){return"0x"+(this.buffer.byteOffset+this.position).toString(16)},end:function(){return this.position===this.buffer.byteLength}},e=0),0<e)for(;e--;)t.readUint8();return{next:function(){if(t.end())return null;if(i={index:t.pos(),delta:t.readVarInt()},240==(240&(r=t.readUint8()))){if(r!==Ye.EVENT_META){if(r===Ye.EVENT_SYSEX||r===Ye.EVENT_DIVSYSEX)return i.type=r,i.length=t.readVarInt(),i.data=t.readBytes(i.length),i;if(n)throw new Error(t.pos()+" Unknown event type "+r.toString(16)+", Delta: "+i.delta+".");return i.type=r,i.badsubtype=t.readVarInt(),i.length=t.readUint8(),i.data=t.readBytes(i.length),i}switch(i.type=Ye.EVENT_META,i.subtype=t.readUint8(),i.length=t.readVarInt(),i.subtype){case Ye.EVENT_META_SEQUENCE_NUMBER:if(n&&2!==i.length)throw new Error(t.pos()+" Bad metaevent length.");return i.msb=t.readUint8(),i.lsb=t.readUint8(),i;case Ye.EVENT_META_TEXT:case Ye.EVENT_META_COPYRIGHT_NOTICE:case Ye.EVENT_META_TRACK_NAME:case Ye.EVENT_META_INSTRUMENT_NAME:case Ye.EVENT_META_LYRICS:case Ye.EVENT_META_MARKER:case Ye.EVENT_META_CUE_POINT:return i.data=t.readBytes(i.length),i;case Ye.EVENT_META_MIDI_CHANNEL_PREFIX:if(n&&1!==i.length)throw new Error(t.pos()+" Bad metaevent length.");return i.prefix=t.readUint8(),i;case Ye.EVENT_META_END_OF_TRACK:if(n&&0!==i.length)throw new Error(t.pos()+" Bad metaevent length.");return i;case Ye.EVENT_META_SET_TEMPO:if(n&&3!==i.length)throw new Error(t.pos()+" Tempo meta event length must be 3.");return i.tempo=(t.readUint8()<<16)+(t.readUint8()<<8)+t.readUint8(),i.tempoBPM=6e7/i.tempo,i;case Ye.EVENT_META_SMTPE_OFFSET:if(n&&5!==i.length)throw new Error(t.pos()+" Bad metaevent length.");if(i.hour=t.readUint8(),n&&23<i.hour)throw new Error(t.pos()+" SMTPE offset hour value must be part of 0-23.");if(i.minutes=t.readUint8(),n&&59<i.minutes)throw new Error(t.pos()+" SMTPE offset minutes value must be part of 0-59.");if(i.seconds=t.readUint8(),n&&59<i.seconds)throw new Error(t.pos()+" SMTPE offset seconds value must be part of 0-59.");if(i.frames=t.readUint8(),n&&30<i.frames)throw new Error(t.pos()+" SMTPE offset frames value must be part of 0-30.");if(i.subframes=t.readUint8(),n&&99<i.subframes)throw new Error(t.pos()+" SMTPE offset subframes value must be part of 0-99.");return i;case Ye.EVENT_META_KEY_SIGNATURE:if(n&&2!==i.length)throw new Error(t.pos()+" Bad metaevent length.");if(i.key=t.readUint8(),n&&(-7>i.key||7<i.key))throw new Error(t.pos()+" Bad metaevent length.");if(i.scale=t.readUint8(),n&&0!==i.scale&&1!==i.scale)throw new Error(t.pos()+" Key signature scale value must be 0 or 1.");return i;case Ye.EVENT_META_TIME_SIGNATURE:if(n&&4!==i.length)throw new Error(t.pos()+" Bad metaevent length.");return i.data=t.readBytes(i.length),i.param1=i.data[0],i.param2=i.data[1],i.param3=i.data[2],i.param4=i.data[3],i;case Ye.EVENT_META_SEQUENCER_SPECIFIC:return i.data=t.readBytes(i.length),i;default:if(n)throw new Error(t.pos()+" Unknown meta event type ("+i.subtype.toString(16)+").");return i.data=t.readBytes(i.length),i}}else{if(0==(128&r)){if(!a)throw new Error(t.pos()+" Running status without previous event");s=r}else a=r>>4,o=15&r,s=t.readUint8();switch(i.type=Ye.EVENT_MIDI,i.subtype=a,i.channel=o,i.param1=s,a){case Ye.EVENT_MIDI_NOTE_OFF:return i.param2=t.readUint8(),i;case Ye.EVENT_MIDI_NOTE_ON:return i.param2=t.readUint8(),i.param2||(i.subtype=Ye.EVENT_MIDI_NOTE_OFF,i.param2=127),i;case Ye.EVENT_MIDI_NOTE_AFTERTOUCH:case Ye.EVENT_MIDI_CONTROLLER:return i.param2=t.readUint8(),i;case Ye.EVENT_MIDI_PROGRAM_CHANGE:case Ye.EVENT_MIDI_CHANNEL_AFTERTOUCH:return i;case Ye.EVENT_MIDI_PITCH_BEND:return i.param2=t.readUint8(),i;default:if(n)throw new Error(t.pos()+" Unknown MIDI event type ("+a.toString(16)+").");return i}}}}},Ye.writeToTrack=function(t,e,n){var r,i,a,o,s=0;for(r=0,i=t.length;r<i;r++){if(t[r].delta>>>28)throw Error("Event #"+r+": Maximum delta time value reached ("+t[r].delta+"/134217728 max)");if(t[r].delta>>>21&&(e[s++]=t[r].delta>>>21&127|128),t[r].delta>>>14&&(e[s++]=t[r].delta>>>14&127|128),t[r].delta>>>7&&(e[s++]=t[r].delta>>>7&127|128),e[s++]=127&t[r].delta,t[r].type===Ye.EVENT_MIDI)e[s++]=(t[r].subtype<<4)+t[r].channel,e[s++]=t[r].param1,-1!==Ye.MIDI_2PARAMS_EVENTS.indexOf(t[r].subtype)&&(e[s++]=t[r].param2);else{if(e[s++]=t[r].type,t[r].type===Ye.EVENT_META&&(e[s++]=t[r].subtype),t[r].length>>>28)throw Error("Event #"+r+": Maximum length reached ("+t[r].length+"/134217728 max)");if(t[r].length>>>21&&(e[s++]=t[r].length>>>21&127|128),t[r].length>>>14&&(e[s++]=t[r].length>>>14&127|128),t[r].length>>>7&&(e[s++]=t[r].length>>>7&127|128),e[s++]=127&t[r].length,t[r].type===Ye.EVENT_META)switch(t[r].subtype){case Ye.EVENT_META_SEQUENCE_NUMBER:e[s++]=t[r].msb,e[s++]=t[r].lsb;break;case Ye.EVENT_META_TEXT:case Ye.EVENT_META_COPYRIGHT_NOTICE:case Ye.EVENT_META_TRACK_NAME:case Ye.EVENT_META_INSTRUMENT_NAME:case Ye.EVENT_META_LYRICS:case Ye.EVENT_META_MARKER:case Ye.EVENT_META_CUE_POINT:for(a=0,o=t[r].length;a<o;a++)e[s++]=t[r].data[a];break;case Ye.EVENT_META_MIDI_CHANNEL_PREFIX:e[s++]=t[r].prefix;break;case Ye.EVENT_META_END_OF_TRACK:break;case Ye.EVENT_META_SET_TEMPO:e[s++]=t[r].tempo>>16,e[s++]=t[r].tempo>>8&255,e[s++]=255&t[r].tempo;break;case Ye.EVENT_META_SMTPE_OFFSET:if(n&&23<t[r].hour)throw new Error("Event #"+r+": SMTPE offset hour value must be part of 0-23.");if(e[s++]=t[r].hour,n&&59<t[r].minutes)throw new Error("Event #"+r+": SMTPE offset minutes value must be part of 0-59.");if(e[s++]=t[r].minutes,n&&59<t[r].seconds)throw new Error("Event #"+r+": SMTPE offset seconds value must be part of 0-59.");if(e[s++]=t[r].seconds,n&&30<t[r].frames)throw new Error("Event #"+r+": SMTPE offset frames amount must be part of 0-30.");if(e[s++]=t[r].frames,n&&99<t[r].subframes)throw new Error("Event #"+r+": SMTPE offset subframes amount must be part of 0-99.");e[s++]=t[r].subframes;break;case Ye.EVENT_META_KEY_SIGNATURE:if("number"!=typeof t[r].key||-7>t[r].key||7<t[r].scale)throw new Error("Event #"+r+":The key signature key must be between -7 and 7");if("number"!=typeof t[r].scale||0>t[r].scale||1<t[r].scale)throw new Error("Event #"+r+":The key signature scale must be 0 or 1");e[s++]=t[r].key,e[s++]=t[r].scale;break;case Ye.EVENT_META_TIME_SIGNATURE:case Ye.EVENT_META_SEQUENCER_SPECIFIC:default:for(a=0,o=t[r].length;a<o;a++)e[s++]=t[r].data[a]}else for(a=0,o=t[r].length;a<o;a++)e[s++]=t[r].data[a]}}},Ye.getRequiredBufferLength=function(t){var e,n=0,r=0;for(r=0,e=t.length;r<e;r++)n+=t[r].delta>>>21?4:t[r].delta>>>14?3:t[r].delta>>>7?2:1,t[r].type===Ye.EVENT_MIDI?(n++,n++,-1!==Ye.MIDI_2PARAMS_EVENTS.indexOf(t[r].subtype)&&n++):(n++,t[r].type===Ye.EVENT_META&&n++,n+=t[r].length>>>21?4:t[r].length>>>14?3:t[r].length>>>7?2:1,n+=t[r].length);return n};var Xe=Ye,Qe={isNotUTF8:function(t,e,n){try{en(t,e,n,!0)}catch(t){return!0}return!1},getCharLength:Je,getCharCode:tn,getStringFromBytes:en,getBytesForCharCode:nn,setBytesFromCharCode:rn,setBytesFromString:function(t,e,n,r,i){t=t||"",e=e||[],n|=0,r="number"==typeof r?r:e.byteLength||1/0;for(var a=0,o=t.length;a<o;a++){var s=nn(t[a].codePointAt(0));if(i&&n+s>r)throw new Error('Not enought bytes to encode the char "'+t[a]+'" at the offset "'+n+'".');rn(t[a].codePointAt(0),e,n,s),n+=s}return e}};function Je(t){return 240==(240&t)?4:224==(224&t)?3:192==(192&t)?2:t==(127&t)?1:0}function tn(t,e,n){var r=0,i="";if(e=e||0,t.length-e<=0)throw new Error("No more characters remaining in array.");if(0==(n=n||Je(t[e])))throw new Error(t[e].toString(2)+" is not a significative byte (offset:"+e+").");if(1===n)return t[e];if(t.length-e<n)throw new Error("Expected at least "+n+" bytes remaining in array.");if(i="00000000".slice(0,n)+1+"00000000".slice(n+1),t[e]&parseInt(i,2))throw Error("Index "+e+": A "+n+" bytes encoded char cannot encode the "+(n+1)+"th rank bit to 1.");for(i="0000".slice(0,n+1)+"11111111".slice(n+1),r+=(t[e]&parseInt(i,2))<<6*--n;n;){if(128!=(128&t[e+1])||64==(64&t[e+1]))throw Error("Index "+(e+1)+': Next bytes of encoded char must begin with a "10" bit sequence.');r+=(63&t[++e])<<6*--n}return r}function en(t,e,n,r){var i,a=[];for(e|=0,n="number"==typeof n?n:t.byteLength||t.length;e<n;e++){if(e+(i=Je(t[e]))>n){if(r)throw Error("Index "+e+": Found a "+i+" bytes encoded char declaration but only "+(n-e)+" bytes are available.")}else a.push(String.fromCodePoint(tn(t,e,i)));e+=i-1}return a.join("")}function nn(t){if(t<128)return 1;if(t<2048)return 2;if(t<65536)return 3;if(t<2097152)return 4;throw new Error("CharCode "+t+" cannot be encoded with UTF8.")}function rn(t,e,n,r){if(t|=0,e=e||[],n|=0,1==(r=r||nn(t)))e[n]=t;else for(e[n++]=(parseInt("1111".slice(0,r),2)<<8-r)+(t>>>6*--r);r>0;)e[n++]=t>>>6*--r&63|128;return e}function an(t,e){var n,r,i,a;if(t){if(25>(t=function(t){if(t){if(t instanceof ArrayBuffer)return t;if(t instanceof Uint8Array)return new Uint8Array(t).buffer}throw new Error("Unsupported buffer type, need ArrayBuffer or Uint8Array")}(t)).byteLength)throw new Error("A buffer of a valid MIDI file must have, at least, a size of 25bytes.");for(this.header=new Ge(t),this.tracks=[],r=Ge.HEADER_LENGTH,i=0,a=this.header.getTracksCount();i<a;i++){if(e&&r>=t.byteLength-1)throw new Error("Couldn't find datas corresponding to the track #"+i+".");n=new We(t,r),this.tracks.push(n),r+=n.getTrackLength()+8}if(e&&r!==t.byteLength)throw new Error("It seems that the buffer contains too much datas.")}else this.header=new Ge,this.tracks=[new We]}an.prototype.getEvents=function(t,e){var n,r,i,a,o,s,l=0,c=[],d=this.header.getFormat(),u=this.header.getTickResolution();if(1!==d||1===this.tracks.length)for(i=0,a=this.tracks.length;i<a;i++)for(l=2===d&&l?l:0,r=(n=Xe.createParser(this.tracks[i].getTrackContent(),0,!1)).next();r;)l+=r.delta?r.delta*u/1e3:0,r.type===Xe.EVENT_META&&r.subtype===Xe.EVENT_META_SET_TEMPO&&(u=this.header.getTickResolution(r.tempo)),t&&r.type!==t||e&&(!r.subtype||r.subtype!==e)||(r.playTime=l,c.push(r)),r=n.next();else{for(o=[],s=-1,i=0,a=this.tracks.length;i<a;i++)o[i]={},o[i].parser=Xe.createParser(this.tracks[i].getTrackContent(),0,!1),o[i].curEvent=o[i].parser.next();do{for(s=-1,i=0,a=o.length;i<a;i++)o[i].curEvent&&(-1===s||o[i].curEvent.delta<o[s].curEvent.delta)&&(s=i);if(-1!==s){for(i=0,a=o.length;i<a;i++)i!==s&&o[i].curEvent&&(o[i].curEvent.delta-=o[s].curEvent.delta);l+=(r=o[s].curEvent).delta?r.delta*u/1e3:0,r.type===Xe.EVENT_META&&r.subtype===Xe.EVENT_META_SET_TEMPO&&(u=this.header.getTickResolution(r.tempo)),t&&r.type!==t||e&&(!r.subtype||r.subtype!==e)||(r.playTime=l,r.track=s,c.push(r)),o[s].curEvent=o[s].parser.next()}}while(-1!==s)}return c},an.prototype.getMidiEvents=function(){return this.getEvents(Xe.EVENT_MIDI)},an.prototype.getLyrics=function(){var t,e,n,r=this.getEvents(Xe.EVENT_META),i=[],a=[];for(e=0,n=r.length;e<n;e++)(t=r[e]).subtype===Xe.EVENT_META_LYRICS?a.push(t):t.subtype===Xe.EVENT_META_TEXT&&("@"===String.fromCharCode(t.data[0])?"T"===String.fromCharCode(t.data[1])||"I"===String.fromCharCode(t.data[1])||String.fromCharCode(t.data[1]):0===String.fromCharCode.apply(String,t.data).indexOf("words")?i.length=0:0!==t.playTime&&i.push(t));2<a.length?i=a:i.length||(i=[]);try{i.forEach((function(t){t.text=Qe.getStringFromBytes(t.data,0,t.length,!0)}))}catch(t){i.forEach((function(t){t.text=t.data.map((function(t){return String.fromCharCode(t)})).join("")}))}return i},an.prototype.getTrackEvents=function(t){var e,n,r=[];if(t>this.tracks.length||0>t)throw Error("Invalid track index ("+t+")");e=(n=Xe.createParser(this.tracks[t].getTrackContent(),0,!1)).next();do{r.push(e),e=n.next()}while(e);return r},an.prototype.setTrackEvents=function(t,e){var n,r;if(t>this.tracks.length||0>t)throw Error("Invalid track index ("+t+")");if(!e||!e.length)throw Error("A track must contain at least one event, none given.");n=Xe.getRequiredBufferLength(e),r=new Uint8Array(n),Xe.writeToTrack(e,r),this.tracks[t].setTrackContent(r)},an.prototype.deleteTrack=function(t){if(t>this.tracks.length||0>t)throw Error("Invalid track index ("+t+")");this.tracks.splice(t,1),this.header.setTracksCount(this.tracks.length)},an.prototype.addTrack=function(t){var e;if(t>this.tracks.length||0>t)throw Error("Invalid track index ("+t+")");e=new We,t===this.tracks.length?this.tracks.push(e):this.tracks.splice(t,0,e),this.header.setTracksCount(this.tracks.length)},an.prototype.getContent=function(){var t,e,n,r,i,a,o,s,l;for(t=Ge.HEADER_LENGTH,r=0,i=this.tracks.length;r<i;r++)t+=this.tracks[r].getTrackLength()+8;for(e=new Uint8Array(t),n=new Uint8Array(this.header.datas.buffer,this.header.datas.byteOffset,Ge.HEADER_LENGTH),r=0,i=Ge.HEADER_LENGTH;r<i;r++)e[r]=n[r];for(a=0,o=this.tracks.length;a<o;a++)for(n=new Uint8Array(this.tracks[a].datas.buffer,this.tracks[a].datas.byteOffset,this.tracks[a].datas.byteLength),s=0,l=this.tracks[a].datas.byteLength;s<l;s++)e[r++]=n[s];return e.buffer},an.Header=Ge,an.Track=We;var on=an;const sn="!@#$%^&*()QWERTYUIOPASDFGHJKLZXCBVNM";class ln{constructor(t,e,n,r,i,a="keep",o="keep"){this.value=t,this.playTime=e,this.delta=i,this.char=un[t-21],this.tempo=n,this.BPM=r,this.valid=t>=21&&t<=108,this.outOfRange=t<=35||t>=97,sn.includes(this.char)?"Start"===a?this.displayValue=t-108:"End"==a&&(this.displayValue=t+108):this.outOfRange?"Start"===o?this.displayValue=t-1024:"End"==o?this.displayValue=t+1024:fn.includes(this.char)?this.displayValue=t-1024:this.displayValue=t+1024:this.displayValue=t}}class cn{constructor(t,e=!0,n=!0){let r=!1,i=t[0];for(let e of t){if(e.playTime!=i.playTime){r=!0;break}i=e}if(this.is_quantized=r,r)r&&(this.notes=n?t:this.#t(t,e));else{let n=[],r=[];t.forEach((t=>{n.includes(t.value)||(n.push(t.value),r.push(t))})),this.notes=this.#t(r,e)}}#t(t,e){return e?this.#e(t):t.sort(((t,e)=>t.displayValue-e.displayValue))}#e(t){let e,n=[],r=[],i=[],a=[],o=[],s=[];t=t.sort(((t,e)=>t.value-e.value));for(const n of t)n.outOfRange?n.value-1024===n.displayValue?o.push(n):n.value+1024===n.displayValue&&s.push(n):(isNaN(n.char)?sn.includes(n.char)?i.push(n):a.push(n):r.push(n),e=n);return e&&(n=sn.includes(e.char)?[...r,...a,...i]:[...i,...r,...a]),[...o,...n,...s]}}class dn{constructor(t){this.chords=t,this.missingTempo=!1}transpose(t,e="Start",n="Start",r=!0,i=!0){if(!this.chords)return;let a=[];return this.chords.forEach((o=>{let s=[];o.notes.forEach((r=>{s.push(new ln(r.value+t,r.playTime,r.tempo,r.BPM,r.delta,e,n))})),a.push(new cn(s,r,i))})),new dn(a)}countNotes(){let t=0;for(let e of this.chords)for(let n of e.notes)t++;return t}text(){let t="",e=this.chords;for(let n=0;n<e.length;n++){if(!e){t+="[no-chords] ";continue}const r=e[n];let i=r.notes.length>1&&r.notes.find((t=>!0===t.valid));r.notes.filter((t=>!1===t.outOfRange)).length<=1&&(i=!1),i&&(t+="[");for(const e of r.notes)t+=e.char;i&&(t+="]"),t+=" "}return t}}const un="1234567890qwert1!2@34$5%6^78*9(0qQwWeErtTyYuiIoOpPasSdDfgGhHjJklLzZxcCvVbBnmyuiopasdfghj",hn="1234567890qwertyuiopasdfghjklzxcvbnm",fn=hn.slice(0,15);function pn(t,e,n=0,r=!1,i=4,a=0){if(!t?.chords)return n;function o(t){let e=[];for(let n of t.chords)for(let t of n.notes)e.push({char:t.char,oor:t.outOfRange,valid:t.valid});let n=e.filter((t=>!1===t.oor&&!0===t.valid)),r=n.filter((t=>hn.includes(t.char))),i=n.filter((t=>!hn.includes(t.char)));return Math.abs(i.length-r.length)}let s=o(t.transpose(n)),l=n;function c(e){let n=o(t.transpose(e));if(n>s){if(!r){if(n-s<=i)return}s=n,l=e}}for(let t=0;t<=e;t++)c(n-t),c(n+t);return l}function mn(t,e){return e<t/4?"-":e<t/2?" ":e<t?" - ":e<2*t?", ":e<3*t?"... ":e<4*t?".... ":"...... "}function _n(t,e,n){const r=t.slice();return r[25]=e[n],r}function gn(t){let e,n,i,a,f,m,v,k,T,x,A,N,S,I,C,M,R,D,U,z,O,L,P,F,V,B,H,Z,q,j,G,K,W,Y,X,Q,J,tt,et,nt,rt,it,at,ot,st,lt,ct,dt,ut,ht,ft,pt,mt,_t,gt,wt,bt,Et,yt,vt,kt,Tt,xt,At,Nt,St,It,Ct,Mt,Rt,Dt,Ut,zt,Ot,$t,Lt,Pt,Ft,Vt,Bt,Ht,Zt,qt,jt,Gt,Kt,Wt=t[0].lbauto_atleast+"",Yt=1==t[0].beats?"1 beat":`${t[0].beats} beats`,Xt=t[0].quantize+"",Qt=t[3],Jt=[];for(let e=0;e<Qt.length;e+=1)Jt[e]=wn(_n(t,Qt,e));let te=1==t[0].missingTempo&&bn(t),ee=t[0].oors&&En(t);function ne(t,e){return t[0].capturingImage?vn:yn}let re=ne(t),ie=re(t),ae="undefined"!=typeof ClipboardItem&&function(t){let e,n,r,i;function a(t,e){return t[0].capturingImage?Tn:kn}let o=a(t),c=o(t);return{c(){e=d("button"),c.c(),e.disabled=n=t[0].capturingImage},m(n,a){s(n,e,a),c.m(e,null),r||(i=p(e,"click",t[23]),r=!0)},p(t,r){o!==(o=a(t))&&(c.d(1),c=o(t),c&&(c.c(),c.m(e,null))),1&r&&n!==(n=t[0].capturingImage)&&(e.disabled=n)},d(t){t&&l(e),c.d(),r=!1,i()}}}(t);return{c(){e=d("div"),n=d("label"),n.textContent="Transpose (sheet) by:",i=h(),a=d("input"),f=h(),m=d("button"),m.textContent="Auto-transpose",v=h(),k=d("div"),T=d("button"),T.textContent="Line-based auto-transpose",x=h(),A=d("label"),A.textContent="Resilience (?):",N=h(),S=d("input"),I=h(),C=d("span"),M=u(Wt),R=h(),D=d("div"),U=d("div"),z=d("label"),z.textContent="Place shifted notes at:",O=h(),L=d("select"),P=d("option"),P.textContent="Start",F=d("option"),F.textContent="End",B=h(),H=d("div"),Z=d("label"),Z.textContent="Place out of range notes at:",q=h(),j=d("select"),G=d("option"),G.textContent="Inorder",K=d("option"),K.textContent="Start",W=d("option"),W.textContent="End",Y=h(),X=d("div"),Q=d("label"),Q.textContent="Font:",J=h(),tt=d("select");for(let t=0;t<Jt.length;t+=1)Jt[t].c();et=h(),nt=d("div"),rt=d("label"),rt.textContent="Break lines:",it=h(),at=d("input"),ot=h(),st=d("span"),lt=u("Every "),ct=u(Yt),dt=h(),te&&te.c(),ut=h(),ht=d("div"),ft=d("label"),ft.textContent="Quantize:",pt=h(),mt=d("input"),_t=h(),gt=d("span"),wt=u(Xt),bt=u(" miliseconds"),Et=h(),yt=d("label"),vt=d("input"),kt=u("\n        Classic chord order"),Tt=h(),xt=d("label"),At=d("input"),Nt=u("\n        Sequential quantizes"),St=h(),It=d("label"),Ct=d("input"),Mt=u("\n        Include out of range (ctrl) notes"),Rt=h(),Dt=d("label"),Ut=d("input"),zt=u("\n        Show tempo marks"),Ot=h(),ee&&ee.c(),$t=h(),Lt=d("button"),Lt.textContent="Copy Text",Pt=h(),Ft=d("button"),Ft.textContent="Copy Transposes",Vt=h(),Bt=d("button"),ie.c(),Zt=h(),ae&&ae.c(),qt=h(),jt=d("style"),jt.textContent='label {\n        max-width: fit-content;\n        text-align: center;\n    }\n\n    .select-div {\n        display: flex;\n        flex-direction: row;\n        align-items: center;\n        text-align: center;\n    }\n\n    select {\n        height: auto;\n        margin-left: 0.4em;\n        margin-top: 0.2em;\n        margin-bottom: 0;\n    }\n\n    input[type="checkbox"] {\n        display: inline-block;\n        vertical-align: middle;\n    }\n\n    input[type="range"] {\n        margin-left: 0.4em;\n        margin-right: 0.4em;\n        margin-bottom: 0;\n    }\n\n    input[type="file"] {\n        margin-bottom: 0;\n    }\n\n    input[type="text"] {\n        margin-bottom: 0;\n    }\n    \n    .beats, .quantize, .select-label, .tempo {\n        display: flex;\n        flex-direction: row;\n    }',_(n,"for","transpose"),_(a,"id","transpose"),_(a,"type","number"),_(a,"min","-24"),_(a,"max","24"),E(e,"display","inline-block"),E(T,"margin-bottom","0"),E(A,"margin-left","0.5em"),E(A,"display","flex"),E(A,"align-items","center"),_(A,"title","Controls how much better a transposition should be than the previous transposition for line-based auto-transpose to act (higher = less transposing)"),_(A,"for","atleast"),_(A,"class","slider-label"),_(S,"id","atleast"),_(S,"type","range"),_(S,"min","1"),_(S,"max","24"),E(C,"display","flex"),E(C,"align-items","center"),_(k,"class","quantize"),_(z,"for","shifts-position"),P.__value="Start",P.value=P.__value,F.__value="End",F.value=F.__value,L.disabled=V=t[0].classicChordOrder,_(L,"name","shifts-position"),_(L,"id","shifts-position"),void 0===t[0].pShifts&&$((()=>t[8].call(L))),_(U,"class","select-div"),_(Z,"for","oors-position"),G.__value="Inorder",G.value=G.__value,K.__value="Start",K.value=K.__value,W.__value="End",W.value=W.__value,_(j,"name","oors-position"),_(j,"id","oors-position"),void 0===t[0].pOors&&$((()=>t[9].call(j))),_(H,"class","select-div"),_(Q,"for","font"),_(tt,"name","font"),_(tt,"id","font"),void 0===t[0].font&&$((()=>t[10].call(tt))),_(X,"class","select-div"),_(rt,"class","slider-label"),_(rt,"for","beats-for-newline"),_(at,"type","range"),_(at,"id","beats-for-newline"),_(at,"min","1"),_(at,"max","32"),_(nt,"class","beats"),_(ft,"class","slider-label"),_(ft,"for","quantize-prompt"),_(mt,"type","range"),_(mt,"id","quantize-prompt"),_(mt,"min","1"),_(mt,"max","100"),_(ht,"class","quantize"),_(vt,"type","checkbox"),_(vt,"id","classic-chord-order"),_(yt,"for","classic-chord-order"),_(At,"type","checkbox"),_(At,"id","order-quantizes"),_(xt,"for","order-quantizes"),_(Ct,"type","checkbox"),_(Ct,"id","out-of-range"),_(It,"for","out-of-range"),_(Ut,"type","checkbox"),_(Ut,"id","tempo-checkbox"),_(Dt,"for","tempo-checkbox"),Bt.disabled=Ht=t[0].capturingImage},m(r,l){s(r,e,l),o(e,n),o(e,i),o(e,a),b(a,t[0].transposition),o(e,f),o(e,m),s(r,v,l),s(r,k,l),o(k,T),o(k,x),o(k,A),o(k,N),o(k,S),b(S,t[0].lbauto_atleast),o(k,I),o(k,C),o(C,M),s(r,R,l),s(r,D,l),o(D,U),o(U,z),o(U,O),o(U,L),o(L,P),o(L,F),y(L,t[0].pShifts),o(D,B),o(D,H),o(H,Z),o(H,q),o(H,j),o(j,G),o(j,K),o(j,W),y(j,t[0].pOors),o(D,Y),o(D,X),o(X,Q),o(X,J),o(X,tt);for(let t=0;t<Jt.length;t+=1)Jt[t].m(tt,null);y(tt,t[0].font),o(D,et),o(D,nt),o(nt,rt),o(nt,it),o(nt,at),b(at,t[0].beats),o(nt,ot),o(nt,st),o(st,lt),o(st,ct),o(D,dt),te&&te.m(D,null),o(D,ut),o(D,ht),o(ht,ft),o(ht,pt),o(ht,mt),b(mt,t[0].quantize),o(ht,_t),o(ht,gt),o(gt,wt),o(gt,bt),o(D,Et),o(D,yt),o(yt,vt),vt.checked=t[0].classicChordOrder,o(yt,kt),o(D,Tt),o(D,xt),o(xt,At),At.checked=t[0].sequentialQuantize,o(xt,Nt),o(D,St),o(D,It),o(It,Ct),Ct.checked=t[0].oors,o(It,Mt),o(D,Rt),o(D,Dt),o(Dt,Ut),Ut.checked=t[0].tempoMarks,o(Dt,zt),o(D,Ot),ee&&ee.m(D,null),o(D,$t),o(D,Lt),o(D,Pt),o(D,Ft),o(D,Vt),o(D,Bt),ie.m(Bt,null),o(D,Zt),ae&&ae.m(D,null),s(r,qt,l),s(r,jt,l),Gt||(Kt=[p(a,"input",t[4]),p(m,"click",t[5]),p(T,"click",t[6]),p(S,"change",t[7]),p(S,"input",t[7]),p(L,"change",t[8]),p(j,"change",t[9]),p(tt,"change",t[10]),p(at,"change",t[11]),p(at,"input",t[11]),p(mt,"change",t[13]),p(mt,"input",t[13]),p(vt,"change",t[14]),p(At,"change",t[15]),p(Ct,"change",t[16]),p(Ut,"change",t[17]),p(Lt,"click",t[20]),p(Ft,"click",t[21]),p(Bt,"click",t[22])],Gt=!0)},p(t,e){if(1&e&&g(a.value)!==t[0].transposition&&b(a,t[0].transposition),1&e&&b(S,t[0].lbauto_atleast),1&e&&Wt!==(Wt=t[0].lbauto_atleast+"")&&w(M,Wt),1&e&&V!==(V=t[0].classicChordOrder)&&(L.disabled=V),1&e&&y(L,t[0].pShifts),1&e&&y(j,t[0].pOors),8&e){let n;for(Qt=t[3],n=0;n<Qt.length;n+=1){const r=_n(t,Qt,n);Jt[n]?Jt[n].p(r,e):(Jt[n]=wn(r),Jt[n].c(),Jt[n].m(tt,null))}for(;n<Jt.length;n+=1)Jt[n].d(1);Jt.length=Qt.length}1&e&&y(tt,t[0].font),1&e&&b(at,t[0].beats),1&e&&Yt!==(Yt=1==t[0].beats?"1 beat":`${t[0].beats} beats`)&&w(ct,Yt),1==t[0].missingTempo?te?te.p(t,e):(te=bn(t),te.c(),te.m(D,ut)):te&&(te.d(1),te=null),1&e&&b(mt,t[0].quantize),1&e&&Xt!==(Xt=t[0].quantize+"")&&w(wt,Xt),1&e&&(vt.checked=t[0].classicChordOrder),1&e&&(At.checked=t[0].sequentialQuantize),1&e&&(Ct.checked=t[0].oors),1&e&&(Ut.checked=t[0].tempoMarks),t[0].oors?ee?ee.p(t,e):(ee=En(t),ee.c(),ee.m(D,$t)):ee&&(ee.d(1),ee=null),re!==(re=ne(t))&&(ie.d(1),ie=re(t),ie&&(ie.c(),ie.m(Bt,null))),1&e&&Ht!==(Ht=t[0].capturingImage)&&(Bt.disabled=Ht),"undefined"!=typeof ClipboardItem&&ae.p(t,e)},d(t){t&&l(e),t&&l(v),t&&l(k),t&&l(R),t&&l(D),c(Jt,t),te&&te.d(),ee&&ee.d(),ie.d(),ae&&ae.d(),t&&l(qt),t&&l(jt),Gt=!1,r(Kt)}}}function wn(e){let n,r,i=e[25]+"";return{c(){n=d("option"),r=u(i),n.__value=e[25],n.value=n.__value},m(t,e){s(t,n,e),o(n,r)},p:t,d(t){t&&l(n)}}}function bn(t){let e,n,i,a,c,f,m,g,E,y=t[0].bpm+"";return{c(){e=d("div"),n=d("label"),n.textContent="BPM (?):",i=h(),a=d("input"),c=h(),f=d("span"),m=u(y),_(n,"class","slider-label"),_(n,"for","tempo"),_(n,"title","You're able to change this because your MIDI file doesn't have tempo/BPM."),_(a,"type","range"),_(a,"id","tempo"),_(a,"min","1"),_(a,"max","300"),_(e,"class","tempo")},m(r,l){s(r,e,l),o(e,n),o(e,i),o(e,a),b(a,t[0].bpm),o(e,c),o(e,f),o(f,m),g||(E=[p(a,"change",t[12]),p(a,"input",t[12])],g=!0)},p(t,e){1&e&&b(a,t[0].bpm),1&e&&y!==(y=t[0].bpm+"")&&w(m,y)},d(t){t&&l(e),g=!1,r(E)}}}function En(t){let e,n,i,a,c,u,f;return{c(){e=d("div"),n=d("label"),n.textContent="Out-of-range separator (?):",i=h(),a=d("div"),c=d("input"),_(n,"title","Helps tell you if notes are out-of-range, certain characters are restricted from use!"),_(n,"for","oor-separator"),_(c,"type","text"),_(c,"id","oor-separator"),E(a,"display","inline-flex")},m(r,l){s(r,e,l),o(e,n),o(e,i),o(e,a),o(a,c),b(c,t[0].oorSeparator),u||(f=[p(c,"input",t[18]),p(c,"input",t[19])],u=!0)},p(t,e){1&e&&c.value!==t[0].oorSeparator&&b(c,t[0].oorSeparator)},d(t){t&&l(e),u=!1,r(f)}}}function yn(t){let e;return{c(){e=u("Download Image")},m(t,n){s(t,e,n)},d(t){t&&l(e)}}}function vn(t){let e;return{c(){e=u("Please Wait...")},m(t,n){s(t,e,n)},d(t){t&&l(e)}}}function kn(t){let e;return{c(){e=u("Copy Image")},m(t,n){s(t,e,n)},d(t){t&&l(e)}}}function Tn(t){let e;return{c(){e=u("Please Wait...")},m(t,n){s(t,e,n)},d(t){t&&l(e)}}}function xn(e){let n,r=e[1]&&gn(e);return{c(){r&&r.c(),n=f()},m(t,e){r&&r.m(t,e),s(t,n,e)},p(t,[e]){t[1]?r?r.p(t,e):(r=gn(t),r.c(),r.m(n.parentNode,n)):r&&(r.d(1),r=null)},i:t,o:t,d(t){r&&r.d(t),t&&l(n)}}}function An(t,e,n){let r=I(),{show:i}=e,a=["Verdana","Tahoma","Dejavu Sans","Segoe UI","Gill Sans","Helvetica","Lucida Sans","Century Gothic"],{settings:o={beats:4,quantize:35,classicChordOrder:!0,sequentialQuantize:!1,pShifts:"Start",pOors:"Inorder",oors:!0,tempoMarks:!1,oorSeparator:":",transposition:0,lbauto_atleast:4,font:a[0],capturingImage:!1,missingTempo:!1,bpm:120}}=e;return t.$$set=t=>{"show"in t&&n(1,i=t.show),"settings"in t&&n(0,o=t.settings)},[o,i,r,a,function(){o.transposition=g(this.value),n(0,o)},()=>{r("auto")},()=>{r("lineBasedAuto")},function(){o.lbauto_atleast=g(this.value),n(0,o)},function(){o.pShifts=v(this),n(0,o)},function(){o.pOors=v(this),n(0,o)},function(){o.font=v(this),n(0,o)},function(){o.beats=g(this.value),n(0,o)},function(){o.bpm=g(this.value),n(0,o)},function(){o.quantize=g(this.value),n(0,o)},function(){o.classicChordOrder=this.checked,n(0,o)},function(){o.sequentialQuantize=this.checked,n(0,o)},function(){o.oors=this.checked,n(0,o)},function(){o.tempoMarks=this.checked,n(0,o)},function(){o.oorSeparator=this.value,n(0,o)},t=>{[null,"0","","    "," ","'","[","]","(",")","{","}","_","-",".",","].concat(un.split("")).includes(t.data?.toLowerCase()??null)?n(0,o.oorSeparator=":",o):n(0,o.oorSeparator=t.data[0],o)},()=>r("copyText"),()=>r("copyTransposes"),()=>r("captureSheetAsImage",{mode:"download"}),()=>r("captureSheetAsImage",{mode:"copy"})]}class Nn extends nt{constructor(t){super(),et(this,t,An,xn,a,{show:1,settings:0})}}function Sn(e){let n,r,i,a,c,h,f,m,g,b=e[1].getTrackLength()+"";return{c(){n=d("div"),r=d("input"),i=u("\n    Track "),a=u(e[2]),c=u(" - "),h=u(b),f=u(" events"),_(r,"type","checkbox"),_(n,"id","track")},m(t,l){s(t,n,l),o(n,r),r.checked=e[0],o(n,i),o(n,a),o(n,c),o(n,h),o(n,f),m||(g=p(r,"change",e[3]),m=!0)},p(t,[e]){1&e&&(r.checked=t[0]),4&e&&w(a,t[2]),2&e&&b!==(b=t[1].getTrackLength()+"")&&w(h,b)},i:t,o:t,d(t){t&&l(n),m=!1,g()}}}function In(t,e,n){let{track:r,idx:i}=e,{selected:a=!1}=e;return t.$$set=t=>{"track"in t&&n(1,r=t.track),"idx"in t&&n(2,i=t.idx),"selected"in t&&n(0,a=t.selected)},[a,r,i,function(){a=this.checked,n(0,a)}]}class Cn extends nt{constructor(t){super(),et(this,t,In,Sn,a,{track:1,idx:2,selected:0})}}const Mn={long:"white",quadruple:"#a3f0a3",whole:"#74da74",half:"#9ada5a",quarter:"#c0c05a",eighth:"#da7e5a",sixteenth:"#daa6a6",thirtysecond:"#ff1900",sixtyfourth:"#9c0f00"};function Rn(t,e){return`<span style="color:${e}">${t}</span>`}function Dn(t){let e,n,r=t[6](t[4])+"";return{c(){e=new A(!1),n=f(),e.a=n},m(t,i){e.m(r,t,i),s(t,n,i)},p(t,n){16&n&&r!==(r=t[6](t[4])+"")&&e.p(r)},d(t){t&&l(n),t&&e.d()}}}function Un(t){let e,n,i,a;return{c(){e=d("span"),n=u(t[0]),_(e,"autofocus",""),_(e,"contenteditable","true"),_(e,"class","comment svelte-jszitz"),void 0===t[0]&&$((()=>t[14].call(e)))},m(r,l){s(r,e,l),o(e,n),void 0!==t[0]&&(e.textContent=t[0]),e.focus(),i||(a=[p(e,"focusout",t[7]),p(e,"input",t[14])],i=!0)},p(t,r){1&r&&w(n,t[0]),1&r&&t[0]!==e.textContent&&(e.textContent=t[0])},d(t){t&&l(e),i=!1,r(a)}}}function zn(e){let n,i,a,c;function u(t,e){return t[0]||""==t[0]?Un:Dn}let h=u(e),f=h(e);return{c(){n=d("div"),i=d("div"),f.c(),_(i,"class","line svelte-jszitz"),_(n,"class","viewer svelte-jszitz"),E(n,"font-family",e[2].font)},m(t,r){s(t,n,r),o(n,i),f.m(i,null),a||(c=[p(i,"mousedown",e[15]),p(i,"contextmenu",m(e[13])),p(n,"contextmenu",m(e[12]))],a=!0)},p(t,[e]){h===(h=u(t))&&f?f.p(t,e):(f.d(1),f=h(t),f&&(f.c(),f.m(i,null))),4&e&&E(n,"font-family",t[2].font)},i:t,o:t,d(t){t&&l(n),f.d(),a=!1,r(c)}}}function On(t,e,n){let r=I(),{index:i}=e,{comment:a}=e,{prevLine:o}=e,{line:s}=e,{passedNext:l}=e,c=new dn(s.chords),d=c,{sameTranspositionAsPrevious:u=!1}=e,{settings:h}=e;function f(t,e,n=" "){let r=t.notes.length>1&&t.notes.find((t=>!0===t.valid));!1===h.oors&&t.notes.filter((t=>!1===t.outOfRange)).length<=1&&(r=!1);let i=t.notes.filter((t=>!1===t.outOfRange)),a=t.notes.filter((t=>!0===t.outOfRange&&t.displayValue===t.value-1024)),o=t.notes.filter((t=>!0===t.outOfRange&&t.displayValue===t.value+1024)),s=`<span style="color:${e};">`,l="";r&&(s+="[",l+="[");for(const e of t.notes)if(e.valid)if(!0===e.outOfRange){if(!0===h.oors){const t=e===a[0],n=e===a[a.length-1],c=!r&&e===o[0],d=r&&0===i.length&&0===a.length&&e===o[0],u=r&&i.length>0&&e===o[0];(t||c||d||u)&&(l+=h.oorSeparator),s+=`<span style="display:inline-flex; justify-content: center; min-width: 10px; border-bottom: 3px solid; font-weight: 900">${e.char}</span>`,l+=`${e.char}${n&&i.length>0?"'":""}`}}else s+=e.char,l+=`${e.char}`;else s+="_",l+="_";return r&&(s+="]",l+="]"),s+="</span>",{dom:s,text:l}}return t.$$set=t=>{"index"in t&&n(1,i=t.index),"comment"in t&&n(0,a=t.comment),"prevLine"in t&&n(9,o=t.prevLine),"line"in t&&n(8,s=t.line),"passedNext"in t&&n(10,l=t.passedNext),"sameTranspositionAsPrevious"in t&&n(11,u=t.sameTranspositionAsPrevious),"settings"in t&&n(2,h=t.settings)},t.$$.update=()=>{268&t.$$.dirty&&(n(8,s.originalSheet=n(3,c=new dn(s.chords)),s),n(4,d=c.transpose(s.transposition,h.pShifts,h.pOors,h.classicChordOrder,h.sequentialQuantize)))},[a,i,h,c,d,r,function(t){const e=-s.transposition;let n="",i="";if(o?.comment&&(i+=o.comment+"\n"),!u){let t=`Transpose by: ${e>0?"+":""}${e}`;s.difference&&(t+=` (${-s.difference>0?"+":""}${-s.difference})`),n+=Rn(t+"\n","white"),i+=t+"\n"}let a=t.chords;for(let t=0;t<a.length;t++){if(!a){n+="[bad-midi-file!]<br>",i+="[bad-midi-file!]";continue}const e={chord:a[t]};e.note=e.chord?.notes[0];const r={chord:a[t+1]};if(r.note=r.chord?.notes[0],!e.note)continue;if(!r.note){if(!l){let t=f(e.chord,"white");n+=t.dom,i+=t.text;continue}r.note=l}let o=e.note.tempo/1e3,s=r.note.playTime-e.note.playTime;e.chord.is_quantized&&(s=r.note.playTime-e.chord.notes.slice(-1)[0].playTime),s-=.5;let c=Mn.long;s<o/16?c=Mn.sixtyfourth:s<o/8?c=Mn.thirtysecond:s<o/4?c=Mn.sixteenth:s<o/2?c=Mn.eighth:s<o?c=Mn.quarter:s<2*o?c=Mn.half:s<4*o?c=Mn.whole:s<8*o?c=Mn.quadruple:s<16*o&&(c=Mn.long);let d=f(e.chord,c);if(n+=d.dom,i+=d.text,h.tempoMarks){let t=mn(o,s);d=Rn(t,c),h.oors||e.chord.notes.some((t=>0==t.outOfRange))?(n+=d,i+=t):(n+=" ",i+=" ")}else n+=" ",i+=" "}return r("sheetText",i.trimEnd()),n},function(){r("comment",""==a||"<br>"==a?{action:"remove",index:+i}:{index:+i,action:"update",comment:a})},s,o,l,u,function(e){C.call(this,t,e)},function(e){C.call(this,t,e)},function(){a=this.textContent,n(0,a)},t=>{switch(t.button){case 0:if(a)return;t.ctrlKey?r("comment",{action:"add",index:+i}):r("transpose",{index:+i,by:1});break;case 1:r("auto",{index:+i,sheet:c,keepGoing:t.ctrlKey}),t.preventDefault();break;case 2:t.ctrlKey&&a?r("comment",{action:"remove",index:+i}):r("transpose",{index:+i,by:-1})}}]}class $n extends nt{constructor(t){super(),et(this,t,On,zn,a,{index:1,comment:0,prevLine:9,line:8,passedNext:10,sameTranspositionAsPrevious:11,settings:2})}}
/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */function Ln(t){let e=t.length;for(;--e>=0;)t[e]=0}const Pn=256,Fn=286,Vn=30,Bn=15,Hn=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Zn=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),qn=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),jn=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Gn=new Array(576);Ln(Gn);const Kn=new Array(60);Ln(Kn);const Wn=new Array(512);Ln(Wn);const Yn=new Array(256);Ln(Yn);const Xn=new Array(29);Ln(Xn);const Qn=new Array(Vn);function Jn(t,e,n,r,i){this.static_tree=t,this.extra_bits=e,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=t&&t.length}let tr,er,nr;function rr(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}Ln(Qn);const ir=t=>t<256?Wn[t]:Wn[256+(t>>>7)],ar=(t,e)=>{t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255},or=(t,e,n)=>{t.bi_valid>16-n?(t.bi_buf|=e<<t.bi_valid&65535,ar(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=n-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=n)},sr=(t,e,n)=>{or(t,n[2*e],n[2*e+1])},lr=(t,e)=>{let n=0;do{n|=1&t,t>>>=1,n<<=1}while(--e>0);return n>>>1},cr=(t,e,n)=>{const r=new Array(16);let i,a,o=0;for(i=1;i<=Bn;i++)o=o+n[i-1]<<1,r[i]=o;for(a=0;a<=e;a++){let e=t[2*a+1];0!==e&&(t[2*a]=lr(r[e]++,e))}},dr=t=>{let e;for(e=0;e<Fn;e++)t.dyn_ltree[2*e]=0;for(e=0;e<Vn;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.sym_next=t.matches=0},ur=t=>{t.bi_valid>8?ar(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},hr=(t,e,n,r)=>{const i=2*e,a=2*n;return t[i]<t[a]||t[i]===t[a]&&r[e]<=r[n]},fr=(t,e,n)=>{const r=t.heap[n];let i=n<<1;for(;i<=t.heap_len&&(i<t.heap_len&&hr(e,t.heap[i+1],t.heap[i],t.depth)&&i++,!hr(e,r,t.heap[i],t.depth));)t.heap[n]=t.heap[i],n=i,i<<=1;t.heap[n]=r},pr=(t,e,n)=>{let r,i,a,o,s=0;if(0!==t.sym_next)do{r=255&t.pending_buf[t.sym_buf+s++],r+=(255&t.pending_buf[t.sym_buf+s++])<<8,i=t.pending_buf[t.sym_buf+s++],0===r?sr(t,i,e):(a=Yn[i],sr(t,a+Pn+1,e),o=Hn[a],0!==o&&(i-=Xn[a],or(t,i,o)),r--,a=ir(r),sr(t,a,n),o=Zn[a],0!==o&&(r-=Qn[a],or(t,r,o)))}while(s<t.sym_next);sr(t,256,e)},mr=(t,e)=>{const n=e.dyn_tree,r=e.stat_desc.static_tree,i=e.stat_desc.has_stree,a=e.stat_desc.elems;let o,s,l,c=-1;for(t.heap_len=0,t.heap_max=573,o=0;o<a;o++)0!==n[2*o]?(t.heap[++t.heap_len]=c=o,t.depth[o]=0):n[2*o+1]=0;for(;t.heap_len<2;)l=t.heap[++t.heap_len]=c<2?++c:0,n[2*l]=1,t.depth[l]=0,t.opt_len--,i&&(t.static_len-=r[2*l+1]);for(e.max_code=c,o=t.heap_len>>1;o>=1;o--)fr(t,n,o);l=a;do{o=t.heap[1],t.heap[1]=t.heap[t.heap_len--],fr(t,n,1),s=t.heap[1],t.heap[--t.heap_max]=o,t.heap[--t.heap_max]=s,n[2*l]=n[2*o]+n[2*s],t.depth[l]=(t.depth[o]>=t.depth[s]?t.depth[o]:t.depth[s])+1,n[2*o+1]=n[2*s+1]=l,t.heap[1]=l++,fr(t,n,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],((t,e)=>{const n=e.dyn_tree,r=e.max_code,i=e.stat_desc.static_tree,a=e.stat_desc.has_stree,o=e.stat_desc.extra_bits,s=e.stat_desc.extra_base,l=e.stat_desc.max_length;let c,d,u,h,f,p,m=0;for(h=0;h<=Bn;h++)t.bl_count[h]=0;for(n[2*t.heap[t.heap_max]+1]=0,c=t.heap_max+1;c<573;c++)d=t.heap[c],h=n[2*n[2*d+1]+1]+1,h>l&&(h=l,m++),n[2*d+1]=h,d>r||(t.bl_count[h]++,f=0,d>=s&&(f=o[d-s]),p=n[2*d],t.opt_len+=p*(h+f),a&&(t.static_len+=p*(i[2*d+1]+f)));if(0!==m){do{for(h=l-1;0===t.bl_count[h];)h--;t.bl_count[h]--,t.bl_count[h+1]+=2,t.bl_count[l]--,m-=2}while(m>0);for(h=l;0!==h;h--)for(d=t.bl_count[h];0!==d;)u=t.heap[--c],u>r||(n[2*u+1]!==h&&(t.opt_len+=(h-n[2*u+1])*n[2*u],n[2*u+1]=h),d--)}})(t,e),cr(n,c,t.bl_count)},_r=(t,e,n)=>{let r,i,a=-1,o=e[1],s=0,l=7,c=4;for(0===o&&(l=138,c=3),e[2*(n+1)+1]=65535,r=0;r<=n;r++)i=o,o=e[2*(r+1)+1],++s<l&&i===o||(s<c?t.bl_tree[2*i]+=s:0!==i?(i!==a&&t.bl_tree[2*i]++,t.bl_tree[32]++):s<=10?t.bl_tree[34]++:t.bl_tree[36]++,s=0,a=i,0===o?(l=138,c=3):i===o?(l=6,c=3):(l=7,c=4))},gr=(t,e,n)=>{let r,i,a=-1,o=e[1],s=0,l=7,c=4;for(0===o&&(l=138,c=3),r=0;r<=n;r++)if(i=o,o=e[2*(r+1)+1],!(++s<l&&i===o)){if(s<c)do{sr(t,i,t.bl_tree)}while(0!=--s);else 0!==i?(i!==a&&(sr(t,i,t.bl_tree),s--),sr(t,16,t.bl_tree),or(t,s-3,2)):s<=10?(sr(t,17,t.bl_tree),or(t,s-3,3)):(sr(t,18,t.bl_tree),or(t,s-11,7));s=0,a=i,0===o?(l=138,c=3):i===o?(l=6,c=3):(l=7,c=4)}};let wr=!1;const br=(t,e,n,r)=>{or(t,0+(r?1:0),3),ur(t),ar(t,n),ar(t,~n),n&&t.pending_buf.set(t.window.subarray(e,e+n),t.pending),t.pending+=n};var Er=(t,e,n,r)=>{let i,a,o=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=(t=>{let e,n=4093624447;for(e=0;e<=31;e++,n>>>=1)if(1&n&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<Pn;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0})(t)),mr(t,t.l_desc),mr(t,t.d_desc),o=(t=>{let e;for(_r(t,t.dyn_ltree,t.l_desc.max_code),_r(t,t.dyn_dtree,t.d_desc.max_code),mr(t,t.bl_desc),e=18;e>=3&&0===t.bl_tree[2*jn[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e})(t),i=t.opt_len+3+7>>>3,a=t.static_len+3+7>>>3,a<=i&&(i=a)):i=a=n+5,n+4<=i&&-1!==e?br(t,e,n,r):4===t.strategy||a===i?(or(t,2+(r?1:0),3),pr(t,Gn,Kn)):(or(t,4+(r?1:0),3),((t,e,n,r)=>{let i;for(or(t,e-257,5),or(t,n-1,5),or(t,r-4,4),i=0;i<r;i++)or(t,t.bl_tree[2*jn[i]+1],3);gr(t,t.dyn_ltree,e-1),gr(t,t.dyn_dtree,n-1)})(t,t.l_desc.max_code+1,t.d_desc.max_code+1,o+1),pr(t,t.dyn_ltree,t.dyn_dtree)),dr(t),r&&ur(t)},yr={_tr_init:t=>{wr||((()=>{let t,e,n,r,i;const a=new Array(16);for(n=0,r=0;r<28;r++)for(Xn[r]=n,t=0;t<1<<Hn[r];t++)Yn[n++]=r;for(Yn[n-1]=r,i=0,r=0;r<16;r++)for(Qn[r]=i,t=0;t<1<<Zn[r];t++)Wn[i++]=r;for(i>>=7;r<Vn;r++)for(Qn[r]=i<<7,t=0;t<1<<Zn[r]-7;t++)Wn[256+i++]=r;for(e=0;e<=Bn;e++)a[e]=0;for(t=0;t<=143;)Gn[2*t+1]=8,t++,a[8]++;for(;t<=255;)Gn[2*t+1]=9,t++,a[9]++;for(;t<=279;)Gn[2*t+1]=7,t++,a[7]++;for(;t<=287;)Gn[2*t+1]=8,t++,a[8]++;for(cr(Gn,287,a),t=0;t<Vn;t++)Kn[2*t+1]=5,Kn[2*t]=lr(t,5);tr=new Jn(Gn,Hn,257,Fn,Bn),er=new Jn(Kn,Zn,0,Vn,Bn),nr=new Jn(new Array(0),qn,0,19,7)})(),wr=!0),t.l_desc=new rr(t.dyn_ltree,tr),t.d_desc=new rr(t.dyn_dtree,er),t.bl_desc=new rr(t.bl_tree,nr),t.bi_buf=0,t.bi_valid=0,dr(t)},_tr_stored_block:br,_tr_flush_block:Er,_tr_tally:(t,e,n)=>(t.pending_buf[t.sym_buf+t.sym_next++]=e,t.pending_buf[t.sym_buf+t.sym_next++]=e>>8,t.pending_buf[t.sym_buf+t.sym_next++]=n,0===e?t.dyn_ltree[2*n]++:(t.matches++,e--,t.dyn_ltree[2*(Yn[n]+Pn+1)]++,t.dyn_dtree[2*ir(e)]++),t.sym_next===t.sym_end),_tr_align:t=>{or(t,2,3),sr(t,256,Gn),(t=>{16===t.bi_valid?(ar(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)})(t)}};var vr=(t,e,n,r)=>{let i=65535&t|0,a=t>>>16&65535|0,o=0;for(;0!==n;){o=n>2e3?2e3:n,n-=o;do{i=i+e[r++]|0,a=a+i|0}while(--o);i%=65521,a%=65521}return i|a<<16|0};const kr=new Uint32Array((()=>{let t,e=[];for(var n=0;n<256;n++){t=n;for(var r=0;r<8;r++)t=1&t?3988292384^t>>>1:t>>>1;e[n]=t}return e})());var Tr=(t,e,n,r)=>{const i=kr,a=r+n;t^=-1;for(let n=r;n<a;n++)t=t>>>8^i[255&(t^e[n])];return-1^t},xr={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Ar={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Nr,_tr_stored_block:Sr,_tr_flush_block:Ir,_tr_tally:Cr,_tr_align:Mr}=yr,{Z_NO_FLUSH:Rr,Z_PARTIAL_FLUSH:Dr,Z_FULL_FLUSH:Ur,Z_FINISH:zr,Z_BLOCK:Or,Z_OK:$r,Z_STREAM_END:Lr,Z_STREAM_ERROR:Pr,Z_DATA_ERROR:Fr,Z_BUF_ERROR:Vr,Z_DEFAULT_COMPRESSION:Br,Z_FILTERED:Hr,Z_HUFFMAN_ONLY:Zr,Z_RLE:qr,Z_FIXED:jr,Z_DEFAULT_STRATEGY:Gr,Z_UNKNOWN:Kr,Z_DEFLATED:Wr}=Ar,Yr=286,Xr=30,Qr=19,Jr=2*Yr+1,ti=15,ei=258,ni=262,ri=42,ii=113,ai=666,oi=(t,e)=>(t.msg=xr[e],e),si=t=>2*t-(t>4?9:0),li=t=>{let e=t.length;for(;--e>=0;)t[e]=0},ci=t=>{let e,n,r,i=t.w_size;e=t.hash_size,r=e;do{n=t.head[--r],t.head[r]=n>=i?n-i:0}while(--e);e=i,r=e;do{n=t.prev[--r],t.prev[r]=n>=i?n-i:0}while(--e)};let di=(t,e,n)=>(e<<t.hash_shift^n)&t.hash_mask;const ui=t=>{const e=t.state;let n=e.pending;n>t.avail_out&&(n=t.avail_out),0!==n&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+n),t.next_out),t.next_out+=n,e.pending_out+=n,t.total_out+=n,t.avail_out-=n,e.pending-=n,0===e.pending&&(e.pending_out=0))},hi=(t,e)=>{Ir(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,ui(t.strm)},fi=(t,e)=>{t.pending_buf[t.pending++]=e},pi=(t,e)=>{t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e},mi=(t,e,n,r)=>{let i=t.avail_in;return i>r&&(i=r),0===i?0:(t.avail_in-=i,e.set(t.input.subarray(t.next_in,t.next_in+i),n),1===t.state.wrap?t.adler=vr(t.adler,e,i,n):2===t.state.wrap&&(t.adler=Tr(t.adler,e,i,n)),t.next_in+=i,t.total_in+=i,i)},_i=(t,e)=>{let n,r,i=t.max_chain_length,a=t.strstart,o=t.prev_length,s=t.nice_match;const l=t.strstart>t.w_size-ni?t.strstart-(t.w_size-ni):0,c=t.window,d=t.w_mask,u=t.prev,h=t.strstart+ei;let f=c[a+o-1],p=c[a+o];t.prev_length>=t.good_match&&(i>>=2),s>t.lookahead&&(s=t.lookahead);do{if(n=e,c[n+o]===p&&c[n+o-1]===f&&c[n]===c[a]&&c[++n]===c[a+1]){a+=2,n++;do{}while(c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&a<h);if(r=ei-(h-a),a=h-ei,r>o){if(t.match_start=e,o=r,r>=s)break;f=c[a+o-1],p=c[a+o]}}}while((e=u[e&d])>l&&0!=--i);return o<=t.lookahead?o:t.lookahead},gi=t=>{const e=t.w_size;let n,r,i;do{if(r=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-ni)&&(t.window.set(t.window.subarray(e,e+e-r),0),t.match_start-=e,t.strstart-=e,t.block_start-=e,t.insert>t.strstart&&(t.insert=t.strstart),ci(t),r+=e),0===t.strm.avail_in)break;if(n=mi(t.strm,t.window,t.strstart+t.lookahead,r),t.lookahead+=n,t.lookahead+t.insert>=3)for(i=t.strstart-t.insert,t.ins_h=t.window[i],t.ins_h=di(t,t.ins_h,t.window[i+1]);t.insert&&(t.ins_h=di(t,t.ins_h,t.window[i+3-1]),t.prev[i&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=i,i++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<ni&&0!==t.strm.avail_in)},wi=(t,e)=>{let n,r,i,a=t.pending_buf_size-5>t.w_size?t.w_size:t.pending_buf_size-5,o=0,s=t.strm.avail_in;do{if(n=65535,i=t.bi_valid+42>>3,t.strm.avail_out<i)break;if(i=t.strm.avail_out-i,r=t.strstart-t.block_start,n>r+t.strm.avail_in&&(n=r+t.strm.avail_in),n>i&&(n=i),n<a&&(0===n&&e!==zr||e===Rr||n!==r+t.strm.avail_in))break;o=e===zr&&n===r+t.strm.avail_in?1:0,Sr(t,0,0,o),t.pending_buf[t.pending-4]=n,t.pending_buf[t.pending-3]=n>>8,t.pending_buf[t.pending-2]=~n,t.pending_buf[t.pending-1]=~n>>8,ui(t.strm),r&&(r>n&&(r=n),t.strm.output.set(t.window.subarray(t.block_start,t.block_start+r),t.strm.next_out),t.strm.next_out+=r,t.strm.avail_out-=r,t.strm.total_out+=r,t.block_start+=r,n-=r),n&&(mi(t.strm,t.strm.output,t.strm.next_out,n),t.strm.next_out+=n,t.strm.avail_out-=n,t.strm.total_out+=n)}while(0===o);return s-=t.strm.avail_in,s&&(s>=t.w_size?(t.matches=2,t.window.set(t.strm.input.subarray(t.strm.next_in-t.w_size,t.strm.next_in),0),t.strstart=t.w_size,t.insert=t.strstart):(t.window_size-t.strstart<=s&&(t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,t.insert>t.strstart&&(t.insert=t.strstart)),t.window.set(t.strm.input.subarray(t.strm.next_in-s,t.strm.next_in),t.strstart),t.strstart+=s,t.insert+=s>t.w_size-t.insert?t.w_size-t.insert:s),t.block_start=t.strstart),t.high_water<t.strstart&&(t.high_water=t.strstart),o?4:e!==Rr&&e!==zr&&0===t.strm.avail_in&&t.strstart===t.block_start?2:(i=t.window_size-t.strstart,t.strm.avail_in>i&&t.block_start>=t.w_size&&(t.block_start-=t.w_size,t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,i+=t.w_size,t.insert>t.strstart&&(t.insert=t.strstart)),i>t.strm.avail_in&&(i=t.strm.avail_in),i&&(mi(t.strm,t.window,t.strstart,i),t.strstart+=i,t.insert+=i>t.w_size-t.insert?t.w_size-t.insert:i),t.high_water<t.strstart&&(t.high_water=t.strstart),i=t.bi_valid+42>>3,i=t.pending_buf_size-i>65535?65535:t.pending_buf_size-i,a=i>t.w_size?t.w_size:i,r=t.strstart-t.block_start,(r>=a||(r||e===zr)&&e!==Rr&&0===t.strm.avail_in&&r<=i)&&(n=r>i?i:r,o=e===zr&&0===t.strm.avail_in&&n===r?1:0,Sr(t,t.block_start,n,o),t.block_start+=n,ui(t.strm)),o?3:1)},bi=(t,e)=>{let n,r;for(;;){if(t.lookahead<ni){if(gi(t),t.lookahead<ni&&e===Rr)return 1;if(0===t.lookahead)break}if(n=0,t.lookahead>=3&&(t.ins_h=di(t,t.ins_h,t.window[t.strstart+3-1]),n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==n&&t.strstart-n<=t.w_size-ni&&(t.match_length=_i(t,n)),t.match_length>=3)if(r=Cr(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=di(t,t.ins_h,t.window[t.strstart+3-1]),n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=di(t,t.ins_h,t.window[t.strstart+1]);else r=Cr(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(r&&(hi(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,e===zr?(hi(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(hi(t,!1),0===t.strm.avail_out)?1:2},Ei=(t,e)=>{let n,r,i;for(;;){if(t.lookahead<ni){if(gi(t),t.lookahead<ni&&e===Rr)return 1;if(0===t.lookahead)break}if(n=0,t.lookahead>=3&&(t.ins_h=di(t,t.ins_h,t.window[t.strstart+3-1]),n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==n&&t.prev_length<t.max_lazy_match&&t.strstart-n<=t.w_size-ni&&(t.match_length=_i(t,n),t.match_length<=5&&(t.strategy===Hr||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){i=t.strstart+t.lookahead-3,r=Cr(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=i&&(t.ins_h=di(t,t.ins_h,t.window[t.strstart+3-1]),n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,r&&(hi(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if(r=Cr(t,0,t.window[t.strstart-1]),r&&hi(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(r=Cr(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,e===zr?(hi(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(hi(t,!1),0===t.strm.avail_out)?1:2};function yi(t,e,n,r,i){this.good_length=t,this.max_lazy=e,this.nice_length=n,this.max_chain=r,this.func=i}const vi=[new yi(0,0,0,0,wi),new yi(4,4,8,4,bi),new yi(4,5,16,8,bi),new yi(4,6,32,32,bi),new yi(4,4,16,16,Ei),new yi(8,16,32,32,Ei),new yi(8,16,128,128,Ei),new yi(8,32,128,256,Ei),new yi(32,128,258,1024,Ei),new yi(32,258,258,4096,Ei)];function ki(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Wr,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(2*Jr),this.dyn_dtree=new Uint16Array(2*(2*Xr+1)),this.bl_tree=new Uint16Array(2*(2*Qr+1)),li(this.dyn_ltree),li(this.dyn_dtree),li(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(ti+1),this.heap=new Uint16Array(2*Yr+1),li(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*Yr+1),li(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Ti=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.status!==ri&&57!==e.status&&69!==e.status&&73!==e.status&&91!==e.status&&103!==e.status&&e.status!==ii&&e.status!==ai?1:0},xi=t=>{if(Ti(t))return oi(t,Pr);t.total_in=t.total_out=0,t.data_type=Kr;const e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=2===e.wrap?57:e.wrap?ri:ii,t.adler=2===e.wrap?0:1,e.last_flush=-2,Nr(e),$r},Ai=t=>{const e=xi(t);var n;return e===$r&&((n=t.state).window_size=2*n.w_size,li(n.head),n.max_lazy_match=vi[n.level].max_lazy,n.good_match=vi[n.level].good_length,n.nice_match=vi[n.level].nice_length,n.max_chain_length=vi[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=2,n.match_available=0,n.ins_h=0),e},Ni=(t,e,n,r,i,a)=>{if(!t)return Pr;let o=1;if(e===Br&&(e=6),r<0?(o=0,r=-r):r>15&&(o=2,r-=16),i<1||i>9||n!==Wr||r<8||r>15||e<0||e>9||a<0||a>jr||8===r&&1!==o)return oi(t,Pr);8===r&&(r=9);const s=new ki;return t.state=s,s.strm=t,s.status=ri,s.wrap=o,s.gzhead=null,s.w_bits=r,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=i+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+3-1)/3),s.window=new Uint8Array(2*s.w_size),s.head=new Uint16Array(s.hash_size),s.prev=new Uint16Array(s.w_size),s.lit_bufsize=1<<i+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new Uint8Array(s.pending_buf_size),s.sym_buf=s.lit_bufsize,s.sym_end=3*(s.lit_bufsize-1),s.level=e,s.strategy=a,s.method=n,Ai(t)};var Si=(t,e)=>{if(Ti(t)||e>Or||e<0)return t?oi(t,Pr):Pr;const n=t.state;if(!t.output||0!==t.avail_in&&!t.input||n.status===ai&&e!==zr)return oi(t,0===t.avail_out?Vr:Pr);const r=n.last_flush;if(n.last_flush=e,0!==n.pending){if(ui(t),0===t.avail_out)return n.last_flush=-1,$r}else if(0===t.avail_in&&si(e)<=si(r)&&e!==zr)return oi(t,Vr);if(n.status===ai&&0!==t.avail_in)return oi(t,Vr);if(n.status===ri&&0===n.wrap&&(n.status=ii),n.status===ri){let e=Wr+(n.w_bits-8<<4)<<8,r=-1;if(r=n.strategy>=Zr||n.level<2?0:n.level<6?1:6===n.level?2:3,e|=r<<6,0!==n.strstart&&(e|=32),e+=31-e%31,pi(n,e),0!==n.strstart&&(pi(n,t.adler>>>16),pi(n,65535&t.adler)),t.adler=1,n.status=ii,ui(t),0!==n.pending)return n.last_flush=-1,$r}if(57===n.status)if(t.adler=0,fi(n,31),fi(n,139),fi(n,8),n.gzhead)fi(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),fi(n,255&n.gzhead.time),fi(n,n.gzhead.time>>8&255),fi(n,n.gzhead.time>>16&255),fi(n,n.gzhead.time>>24&255),fi(n,9===n.level?2:n.strategy>=Zr||n.level<2?4:0),fi(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(fi(n,255&n.gzhead.extra.length),fi(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(t.adler=Tr(t.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69;else if(fi(n,0),fi(n,0),fi(n,0),fi(n,0),fi(n,0),fi(n,9===n.level?2:n.strategy>=Zr||n.level<2?4:0),fi(n,3),n.status=ii,ui(t),0!==n.pending)return n.last_flush=-1,$r;if(69===n.status){if(n.gzhead.extra){let e=n.pending,r=(65535&n.gzhead.extra.length)-n.gzindex;for(;n.pending+r>n.pending_buf_size;){let i=n.pending_buf_size-n.pending;if(n.pending_buf.set(n.gzhead.extra.subarray(n.gzindex,n.gzindex+i),n.pending),n.pending=n.pending_buf_size,n.gzhead.hcrc&&n.pending>e&&(t.adler=Tr(t.adler,n.pending_buf,n.pending-e,e)),n.gzindex+=i,ui(t),0!==n.pending)return n.last_flush=-1,$r;e=0,r-=i}let i=new Uint8Array(n.gzhead.extra);n.pending_buf.set(i.subarray(n.gzindex,n.gzindex+r),n.pending),n.pending+=r,n.gzhead.hcrc&&n.pending>e&&(t.adler=Tr(t.adler,n.pending_buf,n.pending-e,e)),n.gzindex=0}n.status=73}if(73===n.status){if(n.gzhead.name){let e,r=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>r&&(t.adler=Tr(t.adler,n.pending_buf,n.pending-r,r)),ui(t),0!==n.pending)return n.last_flush=-1,$r;r=0}e=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,fi(n,e)}while(0!==e);n.gzhead.hcrc&&n.pending>r&&(t.adler=Tr(t.adler,n.pending_buf,n.pending-r,r)),n.gzindex=0}n.status=91}if(91===n.status){if(n.gzhead.comment){let e,r=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>r&&(t.adler=Tr(t.adler,n.pending_buf,n.pending-r,r)),ui(t),0!==n.pending)return n.last_flush=-1,$r;r=0}e=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,fi(n,e)}while(0!==e);n.gzhead.hcrc&&n.pending>r&&(t.adler=Tr(t.adler,n.pending_buf,n.pending-r,r))}n.status=103}if(103===n.status){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size&&(ui(t),0!==n.pending))return n.last_flush=-1,$r;fi(n,255&t.adler),fi(n,t.adler>>8&255),t.adler=0}if(n.status=ii,ui(t),0!==n.pending)return n.last_flush=-1,$r}if(0!==t.avail_in||0!==n.lookahead||e!==Rr&&n.status!==ai){let r=0===n.level?wi(n,e):n.strategy===Zr?((t,e)=>{let n;for(;;){if(0===t.lookahead&&(gi(t),0===t.lookahead)){if(e===Rr)return 1;break}if(t.match_length=0,n=Cr(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,n&&(hi(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===zr?(hi(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(hi(t,!1),0===t.strm.avail_out)?1:2})(n,e):n.strategy===qr?((t,e)=>{let n,r,i,a;const o=t.window;for(;;){if(t.lookahead<=ei){if(gi(t),t.lookahead<=ei&&e===Rr)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(i=t.strstart-1,r=o[i],r===o[++i]&&r===o[++i]&&r===o[++i])){a=t.strstart+ei;do{}while(r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&i<a);t.match_length=ei-(a-i),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(n=Cr(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(n=Cr(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),n&&(hi(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===zr?(hi(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(hi(t,!1),0===t.strm.avail_out)?1:2})(n,e):vi[n.level].func(n,e);if(3!==r&&4!==r||(n.status=ai),1===r||3===r)return 0===t.avail_out&&(n.last_flush=-1),$r;if(2===r&&(e===Dr?Mr(n):e!==Or&&(Sr(n,0,0,!1),e===Ur&&(li(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),ui(t),0===t.avail_out))return n.last_flush=-1,$r}return e!==zr?$r:n.wrap<=0?Lr:(2===n.wrap?(fi(n,255&t.adler),fi(n,t.adler>>8&255),fi(n,t.adler>>16&255),fi(n,t.adler>>24&255),fi(n,255&t.total_in),fi(n,t.total_in>>8&255),fi(n,t.total_in>>16&255),fi(n,t.total_in>>24&255)):(pi(n,t.adler>>>16),pi(n,65535&t.adler)),ui(t),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?$r:Lr)},Ii={deflateInit:(t,e)=>Ni(t,e,Wr,15,8,Gr),deflateInit2:Ni,deflateReset:Ai,deflateResetKeep:xi,deflateSetHeader:(t,e)=>Ti(t)||2!==t.state.wrap?Pr:(t.state.gzhead=e,$r),deflate:Si,deflateEnd:t=>{if(Ti(t))return Pr;const e=t.state.status;return t.state=null,e===ii?oi(t,Fr):$r},deflateSetDictionary:(t,e)=>{let n=e.length;if(Ti(t))return Pr;const r=t.state,i=r.wrap;if(2===i||1===i&&r.status!==ri||r.lookahead)return Pr;if(1===i&&(t.adler=vr(t.adler,e,n,0)),r.wrap=0,n>=r.w_size){0===i&&(li(r.head),r.strstart=0,r.block_start=0,r.insert=0);let t=new Uint8Array(r.w_size);t.set(e.subarray(n-r.w_size,n),0),e=t,n=r.w_size}const a=t.avail_in,o=t.next_in,s=t.input;for(t.avail_in=n,t.next_in=0,t.input=e,gi(r);r.lookahead>=3;){let t=r.strstart,e=r.lookahead-2;do{r.ins_h=di(r,r.ins_h,r.window[t+3-1]),r.prev[t&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=t,t++}while(--e);r.strstart=t,r.lookahead=2,gi(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,t.next_in=o,t.input=s,t.avail_in=a,r.wrap=i,$r},deflateInfo:"pako deflate (from Nodeca project)"};const Ci=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var Mi={assign:function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const n=e.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(const e in n)Ci(n,e)&&(t[e]=n[e])}}return t},flattenChunks:t=>{let e=0;for(let n=0,r=t.length;n<r;n++)e+=t[n].length;const n=new Uint8Array(e);for(let e=0,r=0,i=t.length;e<i;e++){let i=t[e];n.set(i,r),r+=i.length}return n}};let Ri=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){Ri=!1}const Di=new Uint8Array(256);for(let t=0;t<256;t++)Di[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;Di[254]=Di[254]=1;var Ui={string2buf:t=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(t);let e,n,r,i,a,o=t.length,s=0;for(i=0;i<o;i++)n=t.charCodeAt(i),55296==(64512&n)&&i+1<o&&(r=t.charCodeAt(i+1),56320==(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),i++)),s+=n<128?1:n<2048?2:n<65536?3:4;for(e=new Uint8Array(s),a=0,i=0;a<s;i++)n=t.charCodeAt(i),55296==(64512&n)&&i+1<o&&(r=t.charCodeAt(i+1),56320==(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),i++)),n<128?e[a++]=n:n<2048?(e[a++]=192|n>>>6,e[a++]=128|63&n):n<65536?(e[a++]=224|n>>>12,e[a++]=128|n>>>6&63,e[a++]=128|63&n):(e[a++]=240|n>>>18,e[a++]=128|n>>>12&63,e[a++]=128|n>>>6&63,e[a++]=128|63&n);return e},buf2string:(t,e)=>{const n=e||t.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(t.subarray(0,e));let r,i;const a=new Array(2*n);for(i=0,r=0;r<n;){let e=t[r++];if(e<128){a[i++]=e;continue}let o=Di[e];if(o>4)a[i++]=65533,r+=o-1;else{for(e&=2===o?31:3===o?15:7;o>1&&r<n;)e=e<<6|63&t[r++],o--;o>1?a[i++]=65533:e<65536?a[i++]=e:(e-=65536,a[i++]=55296|e>>10&1023,a[i++]=56320|1023&e)}}return((t,e)=>{if(e<65534&&t.subarray&&Ri)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let n="";for(let r=0;r<e;r++)n+=String.fromCharCode(t[r]);return n})(a,i)},utf8border:(t,e)=>{(e=e||t.length)>t.length&&(e=t.length);let n=e-1;for(;n>=0&&128==(192&t[n]);)n--;return n<0||0===n?e:n+Di[t[n]]>e?n:e}};var zi=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const Oi=Object.prototype.toString,{Z_NO_FLUSH:$i,Z_SYNC_FLUSH:Li,Z_FULL_FLUSH:Pi,Z_FINISH:Fi,Z_OK:Vi,Z_STREAM_END:Bi,Z_DEFAULT_COMPRESSION:Hi,Z_DEFAULT_STRATEGY:Zi,Z_DEFLATED:qi}=Ar;function ji(t){this.options=Mi.assign({level:Hi,method:qi,chunkSize:16384,windowBits:15,memLevel:8,strategy:Zi},t||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zi,this.strm.avail_out=0;let n=Ii.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(n!==Vi)throw new Error(xr[n]);if(e.header&&Ii.deflateSetHeader(this.strm,e.header),e.dictionary){let t;if(t="string"==typeof e.dictionary?Ui.string2buf(e.dictionary):"[object ArrayBuffer]"===Oi.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,n=Ii.deflateSetDictionary(this.strm,t),n!==Vi)throw new Error(xr[n]);this._dict_set=!0}}function Gi(t,e){const n=new ji(e);if(n.push(t,!0),n.err)throw n.msg||xr[n.err];return n.result}ji.prototype.push=function(t,e){const n=this.strm,r=this.options.chunkSize;let i,a;if(this.ended)return!1;for(a=e===~~e?e:!0===e?Fi:$i,"string"==typeof t?n.input=Ui.string2buf(t):"[object ArrayBuffer]"===Oi.call(t)?n.input=new Uint8Array(t):n.input=t,n.next_in=0,n.avail_in=n.input.length;;)if(0===n.avail_out&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),(a===Li||a===Pi)&&n.avail_out<=6)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else{if(i=Ii.deflate(n,a),i===Bi)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),i=Ii.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===Vi;if(0!==n.avail_out){if(a>0&&n.next_out>0)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else if(0===n.avail_in)break}else this.onData(n.output)}return!0},ji.prototype.onData=function(t){this.chunks.push(t)},ji.prototype.onEnd=function(t){t===Vi&&(this.result=Mi.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var Ki={Deflate:ji,deflate:Gi,deflateRaw:function(t,e){return(e=e||{}).raw=!0,Gi(t,e)},gzip:function(t,e){return(e=e||{}).gzip=!0,Gi(t,e)},constants:Ar};const Wi=16209;var Yi=function(t,e){let n,r,i,a,o,s,l,c,d,u,h,f,p,m,_,g,w,b,E,y,v,k,T,x;const A=t.state;n=t.next_in,T=t.input,r=n+(t.avail_in-5),i=t.next_out,x=t.output,a=i-(e-t.avail_out),o=i+(t.avail_out-257),s=A.dmax,l=A.wsize,c=A.whave,d=A.wnext,u=A.window,h=A.hold,f=A.bits,p=A.lencode,m=A.distcode,_=(1<<A.lenbits)-1,g=(1<<A.distbits)-1;t:do{f<15&&(h+=T[n++]<<f,f+=8,h+=T[n++]<<f,f+=8),w=p[h&_];e:for(;;){if(b=w>>>24,h>>>=b,f-=b,b=w>>>16&255,0===b)x[i++]=65535&w;else{if(!(16&b)){if(0==(64&b)){w=p[(65535&w)+(h&(1<<b)-1)];continue e}if(32&b){A.mode=16191;break t}t.msg="invalid literal/length code",A.mode=Wi;break t}E=65535&w,b&=15,b&&(f<b&&(h+=T[n++]<<f,f+=8),E+=h&(1<<b)-1,h>>>=b,f-=b),f<15&&(h+=T[n++]<<f,f+=8,h+=T[n++]<<f,f+=8),w=m[h&g];n:for(;;){if(b=w>>>24,h>>>=b,f-=b,b=w>>>16&255,!(16&b)){if(0==(64&b)){w=m[(65535&w)+(h&(1<<b)-1)];continue n}t.msg="invalid distance code",A.mode=Wi;break t}if(y=65535&w,b&=15,f<b&&(h+=T[n++]<<f,f+=8,f<b&&(h+=T[n++]<<f,f+=8)),y+=h&(1<<b)-1,y>s){t.msg="invalid distance too far back",A.mode=Wi;break t}if(h>>>=b,f-=b,b=i-a,y>b){if(b=y-b,b>c&&A.sane){t.msg="invalid distance too far back",A.mode=Wi;break t}if(v=0,k=u,0===d){if(v+=l-b,b<E){E-=b;do{x[i++]=u[v++]}while(--b);v=i-y,k=x}}else if(d<b){if(v+=l+d-b,b-=d,b<E){E-=b;do{x[i++]=u[v++]}while(--b);if(v=0,d<E){b=d,E-=b;do{x[i++]=u[v++]}while(--b);v=i-y,k=x}}}else if(v+=d-b,b<E){E-=b;do{x[i++]=u[v++]}while(--b);v=i-y,k=x}for(;E>2;)x[i++]=k[v++],x[i++]=k[v++],x[i++]=k[v++],E-=3;E&&(x[i++]=k[v++],E>1&&(x[i++]=k[v++]))}else{v=i-y;do{x[i++]=x[v++],x[i++]=x[v++],x[i++]=x[v++],E-=3}while(E>2);E&&(x[i++]=x[v++],E>1&&(x[i++]=x[v++]))}break}}break}}while(n<r&&i<o);E=f>>3,n-=E,f-=E<<3,h&=(1<<f)-1,t.next_in=n,t.next_out=i,t.avail_in=n<r?r-n+5:5-(n-r),t.avail_out=i<o?o-i+257:257-(i-o),A.hold=h,A.bits=f};const Xi=15,Qi=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Ji=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),ta=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),ea=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var na=(t,e,n,r,i,a,o,s)=>{const l=s.bits;let c,d,u,h,f,p,m=0,_=0,g=0,w=0,b=0,E=0,y=0,v=0,k=0,T=0,x=null;const A=new Uint16Array(16),N=new Uint16Array(16);let S,I,C,M=null;for(m=0;m<=Xi;m++)A[m]=0;for(_=0;_<r;_++)A[e[n+_]]++;for(b=l,w=Xi;w>=1&&0===A[w];w--);if(b>w&&(b=w),0===w)return i[a++]=20971520,i[a++]=20971520,s.bits=1,0;for(g=1;g<w&&0===A[g];g++);for(b<g&&(b=g),v=1,m=1;m<=Xi;m++)if(v<<=1,v-=A[m],v<0)return-1;if(v>0&&(0===t||1!==w))return-1;for(N[1]=0,m=1;m<Xi;m++)N[m+1]=N[m]+A[m];for(_=0;_<r;_++)0!==e[n+_]&&(o[N[e[n+_]]++]=_);if(0===t?(x=M=o,p=20):1===t?(x=Qi,M=Ji,p=257):(x=ta,M=ea,p=0),T=0,_=0,m=g,f=a,E=b,y=0,u=-1,k=1<<b,h=k-1,1===t&&k>852||2===t&&k>592)return 1;for(;;){S=m-y,o[_]+1<p?(I=0,C=o[_]):o[_]>=p?(I=M[o[_]-p],C=x[o[_]-p]):(I=96,C=0),c=1<<m-y,d=1<<E,g=d;do{d-=c,i[f+(T>>y)+d]=S<<24|I<<16|C|0}while(0!==d);for(c=1<<m-1;T&c;)c>>=1;if(0!==c?(T&=c-1,T+=c):T=0,_++,0==--A[m]){if(m===w)break;m=e[n+o[_]]}if(m>b&&(T&h)!==u){for(0===y&&(y=b),f+=g,E=m-y,v=1<<E;E+y<w&&(v-=A[E+y],!(v<=0));)E++,v<<=1;if(k+=1<<E,1===t&&k>852||2===t&&k>592)return 1;u=T&h,i[u]=b<<24|E<<16|f-a|0}}return 0!==T&&(i[f+T]=m-y<<24|64<<16|0),s.bits=b,0};const{Z_FINISH:ra,Z_BLOCK:ia,Z_TREES:aa,Z_OK:oa,Z_STREAM_END:sa,Z_NEED_DICT:la,Z_STREAM_ERROR:ca,Z_DATA_ERROR:da,Z_MEM_ERROR:ua,Z_BUF_ERROR:ha,Z_DEFLATED:fa}=Ar,pa=16180,ma=16190,_a=16191,ga=16192,wa=16194,ba=16199,Ea=16200,ya=16206,va=16209,ka=t=>(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24);function Ta(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const xa=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<pa||e.mode>16211?1:0},Aa=t=>{if(xa(t))return ca;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=pa,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(852),e.distcode=e.distdyn=new Int32Array(592),e.sane=1,e.back=-1,oa},Na=t=>{if(xa(t))return ca;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,Aa(t)},Sa=(t,e)=>{let n;if(xa(t))return ca;const r=t.state;return e<0?(n=0,e=-e):(n=5+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?ca:(null!==r.window&&r.wbits!==e&&(r.window=null),r.wrap=n,r.wbits=e,Na(t))},Ia=(t,e)=>{if(!t)return ca;const n=new Ta;t.state=n,n.strm=t,n.window=null,n.mode=pa;const r=Sa(t,e);return r!==oa&&(t.state=null),r};let Ca,Ma,Ra=!0;const Da=t=>{if(Ra){Ca=new Int32Array(512),Ma=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(na(1,t.lens,0,288,Ca,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;na(2,t.lens,0,32,Ma,0,t.work,{bits:5}),Ra=!1}t.lencode=Ca,t.lenbits=9,t.distcode=Ma,t.distbits=5},Ua=(t,e,n,r)=>{let i;const a=t.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),r>=a.wsize?(a.window.set(e.subarray(n-a.wsize,n),0),a.wnext=0,a.whave=a.wsize):(i=a.wsize-a.wnext,i>r&&(i=r),a.window.set(e.subarray(n-r,n-r+i),a.wnext),(r-=i)?(a.window.set(e.subarray(n-r,n),0),a.wnext=r,a.whave=a.wsize):(a.wnext+=i,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=i))),0};var za=(t,e)=>{let n,r,i,a,o,s,l,c,d,u,h,f,p,m,_,g,w,b,E,y,v,k,T=0;const x=new Uint8Array(4);let A,N;const S=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(xa(t)||!t.output||!t.input&&0!==t.avail_in)return ca;n=t.state,n.mode===_a&&(n.mode=ga),o=t.next_out,i=t.output,l=t.avail_out,a=t.next_in,r=t.input,s=t.avail_in,c=n.hold,d=n.bits,u=s,h=l,k=oa;t:for(;;)switch(n.mode){case pa:if(0===n.wrap){n.mode=ga;break}for(;d<16;){if(0===s)break t;s--,c+=r[a++]<<d,d+=8}if(2&n.wrap&&35615===c){0===n.wbits&&(n.wbits=15),n.check=0,x[0]=255&c,x[1]=c>>>8&255,n.check=Tr(n.check,x,2,0),c=0,d=0,n.mode=16181;break}if(n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&c)<<8)+(c>>8))%31){t.msg="incorrect header check",n.mode=va;break}if((15&c)!==fa){t.msg="unknown compression method",n.mode=va;break}if(c>>>=4,d-=4,v=8+(15&c),0===n.wbits&&(n.wbits=v),v>15||v>n.wbits){t.msg="invalid window size",n.mode=va;break}n.dmax=1<<n.wbits,n.flags=0,t.adler=n.check=1,n.mode=512&c?16189:_a,c=0,d=0;break;case 16181:for(;d<16;){if(0===s)break t;s--,c+=r[a++]<<d,d+=8}if(n.flags=c,(255&n.flags)!==fa){t.msg="unknown compression method",n.mode=va;break}if(57344&n.flags){t.msg="unknown header flags set",n.mode=va;break}n.head&&(n.head.text=c>>8&1),512&n.flags&&4&n.wrap&&(x[0]=255&c,x[1]=c>>>8&255,n.check=Tr(n.check,x,2,0)),c=0,d=0,n.mode=16182;case 16182:for(;d<32;){if(0===s)break t;s--,c+=r[a++]<<d,d+=8}n.head&&(n.head.time=c),512&n.flags&&4&n.wrap&&(x[0]=255&c,x[1]=c>>>8&255,x[2]=c>>>16&255,x[3]=c>>>24&255,n.check=Tr(n.check,x,4,0)),c=0,d=0,n.mode=16183;case 16183:for(;d<16;){if(0===s)break t;s--,c+=r[a++]<<d,d+=8}n.head&&(n.head.xflags=255&c,n.head.os=c>>8),512&n.flags&&4&n.wrap&&(x[0]=255&c,x[1]=c>>>8&255,n.check=Tr(n.check,x,2,0)),c=0,d=0,n.mode=16184;case 16184:if(1024&n.flags){for(;d<16;){if(0===s)break t;s--,c+=r[a++]<<d,d+=8}n.length=c,n.head&&(n.head.extra_len=c),512&n.flags&&4&n.wrap&&(x[0]=255&c,x[1]=c>>>8&255,n.check=Tr(n.check,x,2,0)),c=0,d=0}else n.head&&(n.head.extra=null);n.mode=16185;case 16185:if(1024&n.flags&&(f=n.length,f>s&&(f=s),f&&(n.head&&(v=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(r.subarray(a,a+f),v)),512&n.flags&&4&n.wrap&&(n.check=Tr(n.check,r,f,a)),s-=f,a+=f,n.length-=f),n.length))break t;n.length=0,n.mode=16186;case 16186:if(2048&n.flags){if(0===s)break t;f=0;do{v=r[a+f++],n.head&&v&&n.length<65536&&(n.head.name+=String.fromCharCode(v))}while(v&&f<s);if(512&n.flags&&4&n.wrap&&(n.check=Tr(n.check,r,f,a)),s-=f,a+=f,v)break t}else n.head&&(n.head.name=null);n.length=0,n.mode=16187;case 16187:if(4096&n.flags){if(0===s)break t;f=0;do{v=r[a+f++],n.head&&v&&n.length<65536&&(n.head.comment+=String.fromCharCode(v))}while(v&&f<s);if(512&n.flags&&4&n.wrap&&(n.check=Tr(n.check,r,f,a)),s-=f,a+=f,v)break t}else n.head&&(n.head.comment=null);n.mode=16188;case 16188:if(512&n.flags){for(;d<16;){if(0===s)break t;s--,c+=r[a++]<<d,d+=8}if(4&n.wrap&&c!==(65535&n.check)){t.msg="header crc mismatch",n.mode=va;break}c=0,d=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=_a;break;case 16189:for(;d<32;){if(0===s)break t;s--,c+=r[a++]<<d,d+=8}t.adler=n.check=ka(c),c=0,d=0,n.mode=ma;case ma:if(0===n.havedict)return t.next_out=o,t.avail_out=l,t.next_in=a,t.avail_in=s,n.hold=c,n.bits=d,la;t.adler=n.check=1,n.mode=_a;case _a:if(e===ia||e===aa)break t;case ga:if(n.last){c>>>=7&d,d-=7&d,n.mode=ya;break}for(;d<3;){if(0===s)break t;s--,c+=r[a++]<<d,d+=8}switch(n.last=1&c,c>>>=1,d-=1,3&c){case 0:n.mode=16193;break;case 1:if(Da(n),n.mode=ba,e===aa){c>>>=2,d-=2;break t}break;case 2:n.mode=16196;break;case 3:t.msg="invalid block type",n.mode=va}c>>>=2,d-=2;break;case 16193:for(c>>>=7&d,d-=7&d;d<32;){if(0===s)break t;s--,c+=r[a++]<<d,d+=8}if((65535&c)!=(c>>>16^65535)){t.msg="invalid stored block lengths",n.mode=va;break}if(n.length=65535&c,c=0,d=0,n.mode=wa,e===aa)break t;case wa:n.mode=16195;case 16195:if(f=n.length,f){if(f>s&&(f=s),f>l&&(f=l),0===f)break t;i.set(r.subarray(a,a+f),o),s-=f,a+=f,l-=f,o+=f,n.length-=f;break}n.mode=_a;break;case 16196:for(;d<14;){if(0===s)break t;s--,c+=r[a++]<<d,d+=8}if(n.nlen=257+(31&c),c>>>=5,d-=5,n.ndist=1+(31&c),c>>>=5,d-=5,n.ncode=4+(15&c),c>>>=4,d-=4,n.nlen>286||n.ndist>30){t.msg="too many length or distance symbols",n.mode=va;break}n.have=0,n.mode=16197;case 16197:for(;n.have<n.ncode;){for(;d<3;){if(0===s)break t;s--,c+=r[a++]<<d,d+=8}n.lens[S[n.have++]]=7&c,c>>>=3,d-=3}for(;n.have<19;)n.lens[S[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,A={bits:n.lenbits},k=na(0,n.lens,0,19,n.lencode,0,n.work,A),n.lenbits=A.bits,k){t.msg="invalid code lengths set",n.mode=va;break}n.have=0,n.mode=16198;case 16198:for(;n.have<n.nlen+n.ndist;){for(;T=n.lencode[c&(1<<n.lenbits)-1],_=T>>>24,g=T>>>16&255,w=65535&T,!(_<=d);){if(0===s)break t;s--,c+=r[a++]<<d,d+=8}if(w<16)c>>>=_,d-=_,n.lens[n.have++]=w;else{if(16===w){for(N=_+2;d<N;){if(0===s)break t;s--,c+=r[a++]<<d,d+=8}if(c>>>=_,d-=_,0===n.have){t.msg="invalid bit length repeat",n.mode=va;break}v=n.lens[n.have-1],f=3+(3&c),c>>>=2,d-=2}else if(17===w){for(N=_+3;d<N;){if(0===s)break t;s--,c+=r[a++]<<d,d+=8}c>>>=_,d-=_,v=0,f=3+(7&c),c>>>=3,d-=3}else{for(N=_+7;d<N;){if(0===s)break t;s--,c+=r[a++]<<d,d+=8}c>>>=_,d-=_,v=0,f=11+(127&c),c>>>=7,d-=7}if(n.have+f>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=va;break}for(;f--;)n.lens[n.have++]=v}}if(n.mode===va)break;if(0===n.lens[256]){t.msg="invalid code -- missing end-of-block",n.mode=va;break}if(n.lenbits=9,A={bits:n.lenbits},k=na(1,n.lens,0,n.nlen,n.lencode,0,n.work,A),n.lenbits=A.bits,k){t.msg="invalid literal/lengths set",n.mode=va;break}if(n.distbits=6,n.distcode=n.distdyn,A={bits:n.distbits},k=na(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,A),n.distbits=A.bits,k){t.msg="invalid distances set",n.mode=va;break}if(n.mode=ba,e===aa)break t;case ba:n.mode=Ea;case Ea:if(s>=6&&l>=258){t.next_out=o,t.avail_out=l,t.next_in=a,t.avail_in=s,n.hold=c,n.bits=d,Yi(t,h),o=t.next_out,i=t.output,l=t.avail_out,a=t.next_in,r=t.input,s=t.avail_in,c=n.hold,d=n.bits,n.mode===_a&&(n.back=-1);break}for(n.back=0;T=n.lencode[c&(1<<n.lenbits)-1],_=T>>>24,g=T>>>16&255,w=65535&T,!(_<=d);){if(0===s)break t;s--,c+=r[a++]<<d,d+=8}if(g&&0==(240&g)){for(b=_,E=g,y=w;T=n.lencode[y+((c&(1<<b+E)-1)>>b)],_=T>>>24,g=T>>>16&255,w=65535&T,!(b+_<=d);){if(0===s)break t;s--,c+=r[a++]<<d,d+=8}c>>>=b,d-=b,n.back+=b}if(c>>>=_,d-=_,n.back+=_,n.length=w,0===g){n.mode=16205;break}if(32&g){n.back=-1,n.mode=_a;break}if(64&g){t.msg="invalid literal/length code",n.mode=va;break}n.extra=15&g,n.mode=16201;case 16201:if(n.extra){for(N=n.extra;d<N;){if(0===s)break t;s--,c+=r[a++]<<d,d+=8}n.length+=c&(1<<n.extra)-1,c>>>=n.extra,d-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=16202;case 16202:for(;T=n.distcode[c&(1<<n.distbits)-1],_=T>>>24,g=T>>>16&255,w=65535&T,!(_<=d);){if(0===s)break t;s--,c+=r[a++]<<d,d+=8}if(0==(240&g)){for(b=_,E=g,y=w;T=n.distcode[y+((c&(1<<b+E)-1)>>b)],_=T>>>24,g=T>>>16&255,w=65535&T,!(b+_<=d);){if(0===s)break t;s--,c+=r[a++]<<d,d+=8}c>>>=b,d-=b,n.back+=b}if(c>>>=_,d-=_,n.back+=_,64&g){t.msg="invalid distance code",n.mode=va;break}n.offset=w,n.extra=15&g,n.mode=16203;case 16203:if(n.extra){for(N=n.extra;d<N;){if(0===s)break t;s--,c+=r[a++]<<d,d+=8}n.offset+=c&(1<<n.extra)-1,c>>>=n.extra,d-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=va;break}n.mode=16204;case 16204:if(0===l)break t;if(f=h-l,n.offset>f){if(f=n.offset-f,f>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=va;break}f>n.wnext?(f-=n.wnext,p=n.wsize-f):p=n.wnext-f,f>n.length&&(f=n.length),m=n.window}else m=i,p=o-n.offset,f=n.length;f>l&&(f=l),l-=f,n.length-=f;do{i[o++]=m[p++]}while(--f);0===n.length&&(n.mode=Ea);break;case 16205:if(0===l)break t;i[o++]=n.length,l--,n.mode=Ea;break;case ya:if(n.wrap){for(;d<32;){if(0===s)break t;s--,c|=r[a++]<<d,d+=8}if(h-=l,t.total_out+=h,n.total+=h,4&n.wrap&&h&&(t.adler=n.check=n.flags?Tr(n.check,i,h,o-h):vr(n.check,i,h,o-h)),h=l,4&n.wrap&&(n.flags?c:ka(c))!==n.check){t.msg="incorrect data check",n.mode=va;break}c=0,d=0}n.mode=16207;case 16207:if(n.wrap&&n.flags){for(;d<32;){if(0===s)break t;s--,c+=r[a++]<<d,d+=8}if(4&n.wrap&&c!==(4294967295&n.total)){t.msg="incorrect length check",n.mode=va;break}c=0,d=0}n.mode=16208;case 16208:k=sa;break t;case va:k=da;break t;case 16210:return ua;default:return ca}return t.next_out=o,t.avail_out=l,t.next_in=a,t.avail_in=s,n.hold=c,n.bits=d,(n.wsize||h!==t.avail_out&&n.mode<va&&(n.mode<ya||e!==ra))&&Ua(t,t.output,t.next_out,h-t.avail_out),u-=t.avail_in,h-=t.avail_out,t.total_in+=u,t.total_out+=h,n.total+=h,4&n.wrap&&h&&(t.adler=n.check=n.flags?Tr(n.check,i,h,t.next_out-h):vr(n.check,i,h,t.next_out-h)),t.data_type=n.bits+(n.last?64:0)+(n.mode===_a?128:0)+(n.mode===ba||n.mode===wa?256:0),(0===u&&0===h||e===ra)&&k===oa&&(k=ha),k},Oa={inflateReset:Na,inflateReset2:Sa,inflateResetKeep:Aa,inflateInit:t=>Ia(t,15),inflateInit2:Ia,inflate:za,inflateEnd:t=>{if(xa(t))return ca;let e=t.state;return e.window&&(e.window=null),t.state=null,oa},inflateGetHeader:(t,e)=>{if(xa(t))return ca;const n=t.state;return 0==(2&n.wrap)?ca:(n.head=e,e.done=!1,oa)},inflateSetDictionary:(t,e)=>{const n=e.length;let r,i,a;return xa(t)?ca:(r=t.state,0!==r.wrap&&r.mode!==ma?ca:r.mode===ma&&(i=1,i=vr(i,e,n,0),i!==r.check)?da:(a=Ua(t,e,n,n),a?(r.mode=16210,ua):(r.havedict=1,oa)))},inflateInfo:"pako inflate (from Nodeca project)"};var $a=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const La=Object.prototype.toString,{Z_NO_FLUSH:Pa,Z_FINISH:Fa,Z_OK:Va,Z_STREAM_END:Ba,Z_NEED_DICT:Ha,Z_STREAM_ERROR:Za,Z_DATA_ERROR:qa,Z_MEM_ERROR:ja}=Ar;function Ga(t){this.options=Mi.assign({chunkSize:65536,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zi,this.strm.avail_out=0;let n=Oa.inflateInit2(this.strm,e.windowBits);if(n!==Va)throw new Error(xr[n]);if(this.header=new $a,Oa.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=Ui.string2buf(e.dictionary):"[object ArrayBuffer]"===La.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(n=Oa.inflateSetDictionary(this.strm,e.dictionary),n!==Va)))throw new Error(xr[n])}function Ka(t,e){const n=new Ga(e);if(n.push(t),n.err)throw n.msg||xr[n.err];return n.result}Ga.prototype.push=function(t,e){const n=this.strm,r=this.options.chunkSize,i=this.options.dictionary;let a,o,s;if(this.ended)return!1;for(o=e===~~e?e:!0===e?Fa:Pa,"[object ArrayBuffer]"===La.call(t)?n.input=new Uint8Array(t):n.input=t,n.next_in=0,n.avail_in=n.input.length;;){for(0===n.avail_out&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),a=Oa.inflate(n,o),a===Ha&&i&&(a=Oa.inflateSetDictionary(n,i),a===Va?a=Oa.inflate(n,o):a===qa&&(a=Ha));n.avail_in>0&&a===Ba&&n.state.wrap>0&&0!==t[n.next_in];)Oa.inflateReset(n),a=Oa.inflate(n,o);switch(a){case Za:case qa:case Ha:case ja:return this.onEnd(a),this.ended=!0,!1}if(s=n.avail_out,n.next_out&&(0===n.avail_out||a===Ba))if("string"===this.options.to){let t=Ui.utf8border(n.output,n.next_out),e=n.next_out-t,i=Ui.buf2string(n.output,t);n.next_out=e,n.avail_out=r-e,e&&n.output.set(n.output.subarray(t,t+e),0),this.onData(i)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(a!==Va||0!==s){if(a===Ba)return a=Oa.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(0===n.avail_in)break}}return!0},Ga.prototype.onData=function(t){this.chunks.push(t)},Ga.prototype.onEnd=function(t){t===Va&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Mi.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var Wa={Inflate:Ga,inflate:Ka,inflateRaw:function(t,e){return(e=e||{}).raw=!0,Ka(t,e)},ungzip:Ka,constants:Ar};const{Deflate:Ya,deflate:Xa,deflateRaw:Qa,gzip:Ja}=Ki,{Inflate:to,inflate:eo,inflateRaw:no,ungzip:ro}=Wa;var io={Deflate:Ya,deflate:Xa,deflateRaw:Qa,gzip:Ja,Inflate:to,inflate:eo,inflateRaw:no,ungzip:ro,constants:Ar};const ao="pieces";function oo(t){return JSON.parse(io.inflate(t,{to:"string"}))}const so={getAll:()=>{let t=JSON.parse(localStorage.getItem(ao));return t||(t=[]),console.log(t),t},add:(t,e)=>{let n=so.getAll();console.log(n);let r=function(t,e){return{name:t,data:(n=e,io.deflate(JSON.stringify(n)))};var n}(t,e);n.unshift(r),localStorage.setItem(ao,JSON.stringify(n))}},{document:lo}=W;function co(t,e,n){const r=t.slice();return r[42]=e[n][0],r[43]=e[n][1],r}function uo(t,e,n){const r=t.slice();return r[49]=e[n],r[50]=e,r[51]=n,r}function ho(t){let e,n,r,i,a,u,f,m=t[5],g=[];for(let e=0;e<m.length;e+=1)g[e]=fo(uo(t,m,e));const w=t=>K(g[t],1,1,(()=>{g[t]=null}));return{c(){e=d("section"),n=d("div");for(let t=0;t<g.length;t+=1)g[t].c();r=h(),i=d("button"),i.textContent="Import selected tracks",_(n,"id","tracks"),_(e,"id","track-chooser")},m(l,c){s(l,e,c),o(e,n);for(let t=0;t<g.length;t+=1)g[t].m(n,null);o(e,r),o(e,i),a=!0,u||(f=p(i,"click",t[27]),u=!0)},p(t,e){if(160&e[0]){let r;for(m=t[5],r=0;r<m.length;r+=1){const i=uo(t,m,r);g[r]?(g[r].p(i,e),G(g[r],1)):(g[r]=fo(i),g[r].c(),G(g[r],1),g[r].m(n,null))}for(q(),r=m.length;r<g.length;r+=1)w(r);j()}},i(t){if(!a){for(let t=0;t<m.length;t+=1)G(g[t]);a=!0}},o(t){g=g.filter(Boolean);for(let t=0;t<g.length;t+=1)K(g[t]);a=!1},d(t){t&&l(e),c(g,t),u=!1,f()}}}function fo(t){let e,n,r;function i(e){t[26](e,t[51])}let a={track:t[49],idx:t[51]+1};return void 0!==t[7][t[51]]&&(a.selected=t[7][t[51]]),e=new Cn({props:a}),R.push((()=>Y(e,"selected",i))),{c(){X(e.$$.fragment)},m(t,n){Q(e,t,n),r=!0},p(r,i){t=r;const a={};32&i[0]&&(a.track=t[49]),!n&&128&i[0]&&(n=!0,a.selected=t[7][t[51]],L((()=>n=!1))),e.$set(a)},i(t){r||(G(e.$$.fragment,t),r=!0)},o(t){K(e.$$.fragment,t),r=!1},d(t){J(e,t)}}}function po(t){let e,n,r,i,a,u=Object.entries(t[1]),f=[];for(let e=0;e<u.length;e+=1)f[e]=mo(co(t,u,e));const m=t=>K(f[t],1,1,(()=>{f[t]=null}));return{c(){e=h(),n=d("div"),r=d("div");for(let t=0;t<f.length;t+=1)f[t].c();E(r,"width","max-content"),$((()=>t[32].call(r))),E(n,"background","#2D2A32"),E(n,"user-select","none")},m(c,u){s(c,e,u),s(c,n,u),o(n,r);for(let t=0;t<f.length;t+=1)f[t].m(r,null);i=function(t,e){"static"===getComputedStyle(t).position&&(t.style.position="relative");const n=d("iframe");n.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),n.setAttribute("aria-hidden","true"),n.tabIndex=-1;const r=x();let i;return r?(n.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",i=p(window,"message",(t=>{t.source===n.contentWindow&&e()}))):(n.src="about:blank",n.onload=()=>{i=p(n.contentWindow,"resize",e)}),o(t,n),()=>{(r||i&&n.contentWindow)&&i(),l(n)}}(r,t[32].bind(r)),t[33](n),a=!0},p(t,e){if(1671235&e[0]){let n;for(u=Object.entries(t[1]),n=0;n<u.length;n+=1){const i=co(t,u,n);f[n]?(f[n].p(i,e),G(f[n],1)):(f[n]=mo(i),f[n].c(),G(f[n],1),f[n].m(r,null))}for(q(),n=u.length;n<f.length;n+=1)m(n);j()}},i(t){if(!a){for(let t=0;t<u.length;t+=1)G(f[t]);a=!0}},o(t){f=f.filter(Boolean);for(let t=0;t<f.length;t+=1)K(f[t]);a=!1},d(r){r&&l(e),r&&l(n),c(f,r),i(),t[33](null)}}}function mo(t){let e,n;return e=new $n({props:{line:t[43],prevLine:t[1]?.[t[42]-1],index:t[42],settings:t[0],comment:t[43].comment,passedNext:t[43].continuation,sameTranspositionAsPrevious:t[20](t[42])}}),e.$on("transpose",t[15]),e.$on("auto",t[16]),e.$on("comment",t[19]),e.$on("sheetText",t[31]),{c(){X(e.$$.fragment)},m(t,r){Q(e,t,r),n=!0},p(t,n){const r={};2&n[0]&&(r.line=t[43]),2&n[0]&&(r.prevLine=t[1]?.[t[42]-1]),2&n[0]&&(r.index=t[42]),1&n[0]&&(r.settings=t[0]),2&n[0]&&(r.comment=t[43].comment),2&n[0]&&(r.passedNext=t[43].continuation),2&n[0]&&(r.sameTranspositionAsPrevious=t[20](t[42])),e.$set(r)},i(t){n||(G(e.$$.fragment,t),n=!0)},o(t){K(e.$$.fragment,t),n=!1},d(t){J(e,t)}}}function _o(t){let e,n,r,i,a,c,u,p,m,g,w,b;function y(e){t[23](e)}let v={show:t[4]};void 0!==t[0]&&(v.settings=t[0]),u=new Nn({props:v}),R.push((()=>Y(u,"settings",y))),u.$on("auto",t[13]),u.$on("lineBasedAuto",t[24]),u.$on("captureSheetAsImage",t[18]),u.$on("copyText",t[25]),u.$on("copyTransposes",t[17]);let k=t[3]&&ho(t),T=t[4]&&po(t);return{c(){e=h(),n=d("div"),r=d("label"),r.innerHTML='Please import a MIDI file:\n        <a href="https://github.com/ArijanJ/midi-converter/wiki/Usage">How do I use this?</a>',i=h(),a=d("input"),c=h(),X(u.$$.fragment),m=h(),k&&k.c(),g=h(),T&&T.c(),w=f(),lo.title="MIDI Converter",_(r,"for","file"),_(a,"type","file"),_(a,"accept",".mid,.midi"),E(n,"display","inline-block")},m(l,d){s(l,e,d),s(l,n,d),o(n,r),o(n,i),o(n,a),t[22](a),s(l,c,d),Q(u,l,d),s(l,m,d),k&&k.m(l,d),s(l,g,d),T&&T.m(l,d),s(l,w,d),b=!0},p(t,e){const n={};16&e[0]&&(n.show=t[4]),!p&&1&e[0]&&(p=!0,n.settings=t[0],L((()=>p=!1))),u.$set(n),t[3]?k?(k.p(t,e),8&e[0]&&G(k,1)):(k=ho(t),k.c(),G(k,1),k.m(g.parentNode,g)):k&&(q(),K(k,1,1,(()=>{k=null})),j()),t[4]?T?(T.p(t,e),16&e[0]&&G(T,1)):(T=po(t),T.c(),G(T,1),T.m(w.parentNode,w)):T&&(q(),K(T,1,1,(()=>{T=null})),j())},i(t){b||(G(u.$$.fragment,t),G(k),G(T),b=!0)},o(t){K(u.$$.fragment,t),K(k),K(T),b=!1},d(r){r&&l(e),r&&l(n),t[22](null),r&&l(c),J(u,r),r&&l(m),k&&k.d(r),r&&l(g),T&&T.d(r),r&&l(w)}}}let go=.5;function wo(t,e,n){let r,i,a,o,s,l,c,d,u=!1,h=!1,f=0;var p;function m(t){if(!t)return!1;let e=t.tempo/1e3*g.beats,n=t.playTime-f;return n+go>=e?(f+=n,!0):void 0}p=()=>{r.addEventListener("change",(async()=>{await r.files[0].arrayBuffer().then((t=>{i=new on(t),function(t){return t.header.getTimeDivision()===on.Header.TICKS_PER_BEAT?{ticksPerBeat:t.header.getTicksPerBeat()}:{SMPTEFrames:t.header.getSMPTEFrames(),ticksPerFrame:t.header.getTicksPerFrame()}}(i).ticksPerBeat||console.error("No ticksPerBeat in this midi file"),n(5,a=i.tracks),n(7,l=a.map((()=>!0))),n(3,u=!0),n(4,h=!1),f=0}))}),!1)},S().$$.on_mount.push(p);let _,g,w=()=>{let t=function(t,e){let n=[];return t.getEvents().forEach((t=>{t.subtype==Xe.EVENT_META_SET_TEMPO&&n.push(t),t.subtype==Xe.EVENT_MIDI_NOTE_ON&&(t.track||!0!==e[0]?!0===e[t.track]&&n.push(t):n.push(t))})),n}(i,l);o=function(t,e){let n,r=e.quantize,i=e.pShifts,a=e.pOors,o=e.classicChordOrder,s=e.sequentialQuantize,l=e.bpm,c=[],d=[],u=!1,h=l,f=4166.66*l;t.forEach((t=>{if(81==t.subtype&&(e=t).tempo&&e.tempoBPM&&0!==e.tempo&&0!==e.tempoBPM)return u=!0,f=t.tempo,void(h=t.tempoBPM);var e;const l=t.param1,p=t.playTime,m=t.delta;if(null==n&&(n=p),Math.abs(p-n)<r)d.push(new ln(l,p,f,h,m,i,a)),n=p;else{if(0==d.length)return void(n=p);c.push(new cn(d,o,s)),d=[],d.push(new ln(l,p,f,h,m,i,a)),n=p}})),c.push(new cn(d,o));let p=new dn(c);return u||console.log(`No tempo found in sheet, set to ${h}/${f}`),p.missingTempo=!u,p}(t,g),n(0,g.missingTempo=o.missingTempo,g)},b=()=>{if(n(4,h=!1),!o)return;const t=o.chords;f=0,n(1,y=[]);let e=[];for(let n=0;n<=t.length;n++){const r={chord:t[n]};r.note=r.chord?.notes[0];const i={chord:t[n+1]};i.note=i.chord?.notes[0],r.note&&r.chord&&(m(r.note)&&e.length>0&&(y.push({chords:e,transposition:g.transposition,continuation:r.note}),e=[]),e.push(r.chord))}y.push({chords:e,transposition:0,continuation:void 0}),n(4,h=!0),n(3,u=!1),n(1,y),n(21,_),n(0,g),n(12,b),n(11,w)},E=(t=0)=>{let e=pn(y[t].originalSheet,11,0,!0);for(let n=t;n<=y.length;n++){const t=y[n];if(!t)continue;const r=pn(t.originalSheet,8,e,!1,g.lbauto_atleast,e);v(n,r),e=r}n(1,y),n(21,_),n(0,g),n(12,b),n(11,w)},y=[];function v(t,e){let r=+t;n(1,y[r].transposition=e,y),y[r-1]&&n(1,y[r].difference=y[r].transposition-y[r-1].transposition,y),y[r+1]&&n(1,y[r+1].difference=y[r+1].transposition-y[r].transposition,y)}let k,T=()=>y.reduce(((t,e,n)=>{let r=(t=>{for(t-=1;t>=0;){if(!y[t]?.comment)return y[t].transposition;t-=1}return!1})(n);return e.comment||0!==n&&r===e.transposition||t.push(-e.transposition),t}),[]);function x(t){n(0,g.capturingImage=!0,g),setTimeout((()=>function(t,e){return pt(this,null,(function*(){const n=yield me(t,e),{log:r,type:i,quality:a,dpi:o}=n,s=yield qe(n);r.time("canvas to blob");const l=yield ae(s,i,a);if(["image/png","image/jpeg"].includes(i)&&o){const t=yield le(l.slice(0,33));let e=new Uint8Array(t);return"image/png"===i?e=yt(e,o):"image/jpeg"===i&&(e=function(t,e){return t[13]=1,t[14]=e>>8,t[15]=255&e,t[16]=e>>8,t[17]=255&e,t}(e,o)),r.timeEnd("canvas to blob"),new Blob([e,l.slice(33)],{type:i})}return r.timeEnd("canvas to blob"),l}))}(c,{width:d,scale:2}).then((e=>{"copy"===t?function(t){try{navigator.clipboard.write([new ClipboardItem({"image/png":t})])}catch(t){console.error(t)}}(e):function(t){const e=URL.createObjectURL(t);let n=r.files[0].name.split(".");n.pop(),n=n.join(".")+".png";let i=document.createElement("a");i.href=e,i.download=n,document.body.appendChild(i),i.click(),URL.revokeObjectURL(e),document.body.removeChild(i)}(e),n(0,g.capturingImage=!1,g)}))),250)}return t.$$.update=()=>{if(2097155&t.$$.dirty[0])if(_){if(_.transposition!=g.transposition){for(let t of y)t.transposition=g.transposition;n(1,y),n(21,_),n(0,g),n(12,b),n(11,w)}else _.beats!=g.beats?b():_.quantize!=g.quantize||_.sequentialQuantize!=g.sequentialQuantize||_.classicChordOrder!=g.classicChordOrder?(w(),b(),n(1,y),n(21,_),n(0,g),n(12,b),n(11,w)):_.bpm!=g.bpm&&(w(),b());n(6,s=""),n(21,_={...g})}else n(21,_={...g})},[g,y,r,u,h,a,s,l,c,d,k,w,b,()=>{n(0,g.transposition=pn(o,11),g);for(let t=0;t<y.length;t++)v(t,g.transposition)},E,t=>{const e=t.detail.index,n=t.detail.by;setTimeout((()=>{v(e,y[e].transposition+n)}),0)},t=>{const e=t.detail.keepGoing,n=t.detail.index;v(n,pn(t.detail.sheet,11,y[n-1]?.transposition??0,0,0)),e&&E(n)},()=>{let t=T();navigator.clipboard.writeText(t.join(" "))},function(t){x(t.detail.mode)},function(t){const e=t.detail.index,r=t.detail.action,i=t.detail.comment;switch(r){case"add":setTimeout((()=>{y[e-1]?.comment||(y.splice(e,0,{comment:"Add a comment..."}),n(1,y),n(21,_),n(0,g),n(12,b),n(11,w))}),0);break;case"remove":y.splice(e,1),n(1,y),n(21,_),n(0,g),n(12,b),n(11,w);break;case"update":n(1,y[e].comment=i,y)}},function(t){const e=y[t];for(let n=t-1;n>=0;n--){const t=y[n];if(!t.comment)return t.transposition==e.transposition}},_,function(t){R[t?"unshift":"push"]((()=>{r=t,n(2,r)}))},function(t){g=t,n(0,g)},()=>{E()},()=>{n(0,g.tempoMarks=!0,g),setTimeout((()=>{navigator.clipboard.writeText(s)}),0)},function(e,r){t.$$.not_equal(l[r],e)&&(l[r]=e,n(7,l))},()=>{w(),b()},()=>{n(10,k=so.getAll())},()=>{let t=r.files[0].name.split(".").slice(0,-1);so.add(t,y)},t=>{console.log(oo(t.data)),n(1,y=oo(t.data))},t=>n(6,s+=t.detail+"\n"),function(){d=this.clientWidth,n(9,d)},function(t){R[t?"unshift":"push"]((()=>{c=t,n(8,c)}))}]}return new class extends nt{constructor(t){super(),et(this,t,wo,_o,a,{},null,[-1,-1])}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
